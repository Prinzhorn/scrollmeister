/*!
 * Scrollmeister v0.0.1 (May 1st 2018)
 * Open-source JavaScript framework to declaratively build scrolling experiences
 * 
 * https://www.scrollmeister.com
 * 
 * @author  Alexander Prinzhorn (https://www.prinzhorn.it)
 * @license MIT
 * 
 * This bundle contains the following npm packages: document-register-element, linear-partitioning, object-assign, raf, regl, resize-observer-polyfill, scroll-logic, youtube-iframe
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Scrollmeister=e()}}(function(){var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(r,i){for(var o,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(r),u=1;u<arguments.length;u++){for(var l in o=Object(arguments[u]))t.call(o,l)&&(s[l]=o[l]);if(e){a=e(o);for(var c=0;c<a.length;c++)n.call(o,a[c])&&(s[a[c]]=o[a[c]])}}return s},i={};Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})};var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=["display","overflow","contain","transform","backfaceVisibility","willChange","opacity","position","left","top","right","bottom","width","height","maxWidth","minWidth","maxHeight","minHeight","transition","whiteSpace","fontSize","cursor","pointerEvents","background","backgroundImage","backgroundColor","backgroundSize","visibility"];var a={};Object.defineProperty(a,"__esModule",{value:!0}),a.default={parse:function(e){return"true"===(e=e.trim())||"on"===e||"yes"===e||"1"===e},stringify:function(e){return String(e)}};var s={};Object.defineProperty(s,"__esModule",{value:!0});var u=["px","vw","vh","vmin","vmax","%"],l=new RegExp("[\\d.]("+u.join("|")+")$");s.default={parse:function(e){if("0"===(e=e.trim()))return{length:0,unit:"px"};var t=e.match(l),n=parseFloat(e);if(!t)throw new Error('The value "'+e+'" uses a unit that is not supported by Scrollmeister. Supported units are '+u.join(", ")+".");if(isNaN(n))throw new Error('Could not parse "'+e+'" as a number.');return{length:n,unit:t[1]}},stringify:function(e){return""+e.length+e.unit}};var c={};Object.defineProperty(c,"__esModule",{value:!0});var f,h=(f=s)&&f.__esModule?f:{default:f},p=/^(\d+)\s*\/\s*(\d+)$/;c.default={parse:function(e){if("auto"===(e=e.trim()))return e;var t=e.match(p);return t?{length:parseInt(t[2],10)/parseInt(t[1],10)*100,unit:"%"}:h.default.parse(e)},stringify:function(e){return"auto"===e?e:h.default.stringify(e)}};var d={};Object.defineProperty(d,"__esModule",{value:!0});var v=/skip\s+(\d+)/,y=/consume\s+(\d+)/;function m(e){return e.hasAttribute("layout")&&"flow"===e.layout.props.mode}function b(e){for(var t=e;t.previousSibling;)if((t=t.previousSibling).nodeType===Node.ELEMENT_NODE&&m(t))return t;return null}d.default={parse:function(e,t){return{nodes:function e(t,n){if("none"===t)return[];if("inherit"===t){var r=b(n);return r?[r.layout]:[]}if(-1!==t.indexOf("skip")||-1!==t.indexOf("consume")){var i=v.test(t)?parseInt(t.match(v)[1],10):0,o=y.test(t)?parseInt(t.match(y)[1],10):1;if(0===i&&1===o)return e("inherit",n);if(i<0)throw new Error("You've specified a non-positive number of skips ("+i+") for the layout dependencies.");if(o<1)throw new Error("You have specified less than 1 ("+o+') for "consume" for the layout dependencies..');var a=n;do{a=b(a)}while(a&&i--);if(!a)return[];var s=[];do{s.push(a.layout),a=b(a)}while(a&&--o);return s}var u=Array.prototype.slice.call(document.querySelectorAll(t)).filter(m);if(0===u.length)throw new Error("Couldn't resolve the layout dependency \""+t+'". No flow elements found matching this selector.');return u.map(function(e){return e.layout})}(e=e.trim(),t),value:e}},stringify:function(e){return e.value}};var g={};Object.defineProperty(g,"__esModule",{value:!0});var _=/^-?[\d.+]+$/;g.default={parse:function(e){if(e=e.trim(),!_.test(e))throw new Error('The value "'+e+'" does not look like a number.');var t=parseFloat(e);if(isNaN(t))throw new Error('Could not parse "'+e+'" as a number.');return t},stringify:function(e){return""+e}};var w={};Object.defineProperty(w,"__esModule",{value:!0});var x=/^(\d+)\s*\/\s*(\d+)$/;w.default={parse:function(e){var t=(e=e.trim()).match(x);if(!t)throw new Error('The value "'+e+' does not look like a ratio. The syntax is "width / height", e.g. "1920 / 1080".');return{num:parseInt(t[1],10)/parseInt(t[2],10),value:e}},stringify:function(e){return e.value}};var T={};Object.defineProperty(T,"__esModule",{value:!0}),T.default={parse:function(e){return e.trim()},stringify:function(e){return e}};var O={};Object.defineProperty(O,"__esModule",{value:!0}),O.default={parse:function(e,t){var n=void 0;if("auto"===(e=e.trim()))n=t.getElementsByTagName("script")[0];else{var r=document.getElementById(e);if(!(r instanceof HTMLScriptElement))throw new Error('The shader "'+e+'" is not the ID of a <script> element.');n=r}if(!n)throw new Error('Could not find shader "'+e+'".');return{template:n.text,value:e}},stringify:function(e){return e.value}};var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.domtypes=void 0;var k=L(a),S=L(s),M=L(w),P=L(c),j=L(d),A=L(g),C=L(T),D=L(O);function L(e){return e&&e.__esModule?e:{default:e}}E.default={boolean:k.default,csslength:S.default,height:P.default,ratio:M.default,layoutdependencies:j.default,number:A.default,string:C.default,template:D.default},E.domtypes=["layoutdependencies"];var H={};Object.defineProperty(H,"__esModule",{value:!0});var B,N=(B=E)&&B.__esModule?B:{default:B},R=/([^:;]+):([^;]+)/g,I=/\s+/;H.default={parseProperties:function(e,t,n,r){var i={},o=void 0;for(R.lastIndex=0;null!==(o=R.exec(n));){var a=o[1].trim(),s=o[2];if(!t.hasOwnProperty(a))throw new Error('You have defined a property "'+a+'" in your attribute that is not expected. The value was "'+s+'".');i[a]=s}for(var u in t)if(t.hasOwnProperty(u)){var l=void 0;if(i.hasOwnProperty(u))l=i[u];else{if(!t[u].hasOwnProperty("default"))throw new Error('You are missing the "'+u+'" property, which has no default value.');l=t[u].default}var c=this.parseProperty(e,u,l,t[u].type,t[u].expand),f=t[u].enum;if(f instanceof Array&&-1===f.indexOf(c))throw new Error('Got "'+c+'" as value for property "'+u+'". Expected one of "'+f.join('", "')+'".');r[u]=c}},parseProperty:function(e,t,n,r,i){var o=this;if(n=n.trim(),r instanceof Array){if(1===r.length)return(r=r[0])instanceof Array?""===n?[]:n.split(",").map(function(n){return o.parseProperty(e,t,n,r,i)}):""===n?[]:n.split(",").map(function(t){return N.default[r].parse(t,e)});if(r.length>1){if(""===n)return[];var a=n.split(I);if(!(a.length===r.length||i&&i(a)))throw new Error('The schema for the "'+t+'" property expects '+r.length+" values. Got "+a.length+', namely "'+a.join(" ")+'".');for(var s={},u=0;u<a.length;u++){var l=r[u],c=Object.keys(l);if(1!==c.length)throw new Error("A nested schema should have exactly one key (the name) which maps to the type.");var f=c[0],h=a[u];s[f]=N.default[l[f]].parse(h,e)}return s}throw new Error('You have defined an empty array as schema type for the "'+t+'" property.')}return N.default[r].parse(n,e)},stringifyProperties:function(e,t,n){var r=[];for(var i in n){var o=n[i],a=t[i].type,s=this.stringifyProperty(e,o,a);r.push(i+": "+s)}return r.join("; ")+";"},stringifyProperty:function(e,t,n){var r=this;if(!(n instanceof Array))return N.default[n].stringify(t,e);if(1===n.length){var i=n[0];return i instanceof Array?t.map(function(t){return r.stringifyProperty(e,t,i)}).join(", "):t.map(function(t){return N.default[i].stringify(t,e)}).join(", ")}return n.length>1?n.map(function(e){var n=Object.keys(e)[0],r=e[n];return N.default[r].stringify(t[n])}).join(" "):void 0}};var F={};Object.defineProperty(F,"__esModule",{value:!0});var z=window.CustomEvent;"function"!=typeof z&&((z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1},n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}).prototype=window.Event.prototype),F.default=z;var W={};Object.defineProperty(W,"__esModule",{value:!0});var V=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),q=X(r),U=X(i),Y=X(F),G=X(o),Q=X(H);function X(e){return e&&e.__esModule?e:{default:e}}var $=!!function(){var e=void 0;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){e=!1}return e}()&&{passive:!1};function K(e,t,n){return 2===arguments.length&&(n=t,"^"===(t=e).charAt(0)?(t=t.slice(1),e=this.parentEl):e=this.el),{element:e,eventName:t,callback:n}}var Z=function(){function e(t,n,r){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=this.constructor.behaviorName;t[i]=this,t[(0,U.default)(i)]=this,t.behaviors[i]=this,this.hasNotifiedAtLeastOnce=!1,this.el=t,this.contentEl=n,this.parentEl=t.parentElement,this.props={},this._shadowChildren=[],this._observeDOMTypes(),this._proxyCSS(),this._proxyProps(),this._parseProperties(r),this.behaviorDidAttach&&this.behaviorDidAttach(),this.emit("attach")}return V(e,null,[{key:"behaviorSchema",get:function(){throw new Error('Your behavior class "'+this.constructor.name+'" needs to implement the static "behaviorSchema" getter.')}},{key:"behaviorName",get:function(){throw new Error('Your behavior class "'+this.constructor.name+'" needs to implement the static "behaviorName" getter.')}},{key:"behaviorDependencies",get:function(){throw new Error('Your behavior class "'+this.constructor.name+'" needs to implement the static "behaviorDependencies" getter.')}}]),V(e,[{key:"destructor",value:function(){if(this.behaviorWillDetach&&this.behaviorWillDetach(),this.listeners)for(var e=0;e<this.listeners.length;e++){var t=this.listeners[e];this.unlisten(t.element,t.eventName,t.callback)}var n=this._findShadowMeister();if(n){for(var r=0;r<this._shadowChildren.length;r++)n.removeChild(this._shadowChildren[r]);this._shadowChildren.length=0}this._unproxyCSS(),this.emit("detach");var i=this.constructor.behaviorName;delete this.el[i],delete this.el[(0,U.default)(i)],delete this.el.behaviors[i]}},{key:"error",value:function(e){throw this.el.renderError(e),e}},{key:"notify",value:function(){this.hasNotifiedAtLeastOnce=!0,this.emit("change")}},{key:"connectTo",value:function(e,t,n){if(-1===this.constructor.behaviorDependencies.indexOf(e))throw new Error('You are trying to connect the "'+this.constructor.behaviorName+'" behavior to the "'+e+'" behavior, which is not listed as dependency.');var r=this.el;"^"===e.charAt(0)&&(e=e.slice(1),r=this.parentEl);var i=r[e],o=function(){o=t,n&&n(i),t(i)};this.listen(r,e+":change",function(){o(i)}),this.listen(this.constructor.behaviorName+":update",function(){i.hasNotifiedAtLeastOnce&&o(i)}),i.hasNotifiedAtLeastOnce&&o(i)}},{key:"listen",value:function(e,t,n){var r=this,i=K.apply(this,arguments);e=i.element,t=i.eventName,n=i.callback,-1===t.indexOf(" ")?(e.addEventListener(t,n,$),this.listeners||(this.listeners=[]),this.listeners.push({element:e,eventName:t,callback:n})):t.split(" ").map(function(e){return e.trim()}).forEach(function(t){r.listen(e,t,n)})}},{key:"listenOnce",value:function(e,t,n){var r=K.apply(this,arguments);e=r.element,t=r.eventName;var i=this;function o(){i.unlisten(e,t,o),n.apply(this,arguments)}if("function"==typeof(n=r.callback)._once)throw new Error("You cannot use the same listener for multiple events with listenOnce");n._once=o,this.listen(e,t,o)}},{key:"listenAndInvoke",value:function(e,t,n){var r=K.apply(this,arguments);e=r.element,t=r.eventName,n=r.callback,this.listen(e,t,n),n()}},{key:"unlisten",value:function(e,t,n){var r=K.apply(this,arguments);e=r.element,t=r.eventName,"function"==typeof(n=r.callback)._once&&delete(n=n._once)._once,e.removeEventListener(t,n,$)}},{key:"emit",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=this.constructor.behaviorName+":"+e;var n=new Y.default(e,{bubbles:t,cancelable:!1,detail:this});this.el.dispatchEvent(n)}},{key:"_findShadowMeister",value:function(){for(var e=this.el.children.length-1;e>0;e--){var t=this.el.children[e];if("SHADOW-MEISTER"===t.tagName.toUpperCase())return t}return null}},{key:"appendChild",value:function(e){var t=this._findShadowMeister();t||(t=document.createElement("shadow-meister"),this.el.appendChild(t)),t.appendChild(e),this._shadowChildren.push(e)}},{key:"removeChild",value:function(e){var t=this._findShadowMeister();if(!t)throw new Error("You have called removeChild, but there is no shadow-meister. Did you append the element using Behavior.appendChild?");var n=this._shadowChildren.indexOf(e);-1!==n&&(t.removeChild(e),this._shadowChildren.splice(n,1))}},{key:"updateProperties",value:function(e){var t=(0,q.default)({},this.props);if("string"==typeof e)this._parseProperties(e);else for(var n in e)e.hasOwnProperty(n)&&this._parseProperty(n,e[n]);this.update&&this.update(t),this.emit("update")}},{key:"_updateProperty",value:function(e,t){var n=(0,q.default)({},this.props);this._parseProperty(e,t),this.update&&this.update(n),this.emit("update")}},{key:"_observeDOMTypes",value:function(){var e=this,t=[],n=this.constructor.behaviorSchema;for(var r in n)n.hasOwnProperty(r)&&-1!==E.domtypes.indexOf(n[r].type)&&t.push(r);t.length>0&&this.listen(document,"scrollmeister:connected scrollmeister:disconnected",function(){for(var n={},r=0;r<t.length;r++){var i=t[r];n[i]=e[i]}e.updateProperties(n)})}},{key:"_proxyCSS",value:function(){for(var e=this.constructor.behaviorName,t=this.el,n=this.contentEl,r=this.style=Object.create(null),i=this.contentStyle=Object.create(null),o=function(o){var a=G.default[o];Object.defineProperty(r,a,{set:function(n){""===n?t.resetBehaviorStyle(e,a):t.setBehaviorStyle(e,a,n)}}),Object.defineProperty(i,a,{set:function(t){""===t?n.resetBehaviorStyle(e,a):n.setBehaviorStyle(e,a,t)}})},a=0;a<G.default.length;a++)o(a)}},{key:"_unproxyCSS",value:function(){var e=this.constructor.behaviorName;this.el.resetBehaviorStyles(e),this.contentEl&&this.contentEl.resetBehaviorStyles(e)}},{key:"_proxyProps",value:function(){var e=this,t=this.constructor.behaviorSchema,n=function(n){t.hasOwnProperty(n)&&Object.defineProperty(e,n,{get:function(){return Q.default.stringifyProperty(this.el,this.props[n],t[n].type)},set:function(e){this._updateProperty(n,e)}})};for(var r in t)n(r)}},{key:"_parseProperties",value:function(e){var t=this.constructor.behaviorSchema;try{Q.default.parseProperties(this.el,t,e,this.props)}catch(e){this.error(e)}}},{key:"_parseProperty",value:function(e,t){t=t.trim();var n=this.constructor.behaviorSchema[e],r=n.type,i=n.expand;if(""===t){if(!n.hasOwnProperty("default"))throw new Error('The "'+e+'" property does not have a default value. It cannot be unset using an empty string.');t=n.default}this.props[e]=Q.default.parseProperty(this.el,e,t,r,i)}}]),e}();W.default=Z;var J={};Object.defineProperty(J,"__esModule",{value:!0});var ee,te=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ne=(ee=W)&&ee.__esModule?ee:{default:ee},re=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,ne.default),te(t,[{key:"behaviorDidAttach",value:function(){var e=this.el.querySelector("video");this.listen("layout:viewport:enter",function(){e.play()}),this.listen("layout:viewport:leave",function(){e.pause()})}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"autoplay"}},{key:"behaviorDependencies",get:function(){return["layout"]}}]),t}();J.default=re;var ie={};Object.defineProperty(ie,"__esModule",{value:!0});var oe,ae=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),se=(oe=W)&&oe.__esModule?oe:{default:oe},ue=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,se.default),ae(t,[{key:"addClass",value:function(e){this.el.classList?this.el.classList.add(e):this.el.className=this.el.className+" "+e}},{key:"removeClass",value:function(e){this.el.classList?this.el.classList.remove(e):this.el.className=this.el.className.replace(new RegExp("(?:^|\\s)"+e+"(?!\\S)"),"")}},{key:"onSignal",value:function(e,t){switch(e){case"add":this.addClass(t);break;case"remove":this.removeClass(t);break;default:this.error(new Error('Received an unknown signal "'+e+'".'))}}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"css"}},{key:"behaviorDependencies",get:function(){return[]}}]),t}();ie.default=ue;var le={};Object.defineProperty(le,"__esModule",{value:!0}),le.default=function(e){var t=e.cloneNode(!0);ce.appendChild(t),t.style.display="inline-block",t.style.whiteSpace="nowrap",t.style.fontSize="100px",t.style.width="auto",e.parentElement.appendChild(ce);var n=100/t.clientWidth;return e.parentElement.removeChild(ce),ce.removeChild(t),n};var ce=document.createElement("div");ce.style.cssText="\n\twidth: 0;\n\theight: 0;\n\toverflow: hidden;\n\tposition: fixed;\n\tbottom: -100px;\n\tright: -100px;\n\topacity:0;\n\tpointer-events:none;\n";var fe={};Object.defineProperty(fe,"__esModule",{value:!0});var he=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),pe=ve(W),de=ve(le);function ve(e){return e&&e.__esModule?e:{default:e}}var ye=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,pe.default),he(t,[{key:"behaviorDidAttach",value:function(){var e=this;1!==this.contentEl.children.length&&this.error(new Error("The fluidtext behavior expects a single child element. We recommend an <h1>, since the behavior is most suited for headlines.")),this.contentStyle.whiteSpace="nowrap",this.connectTo("layout",function(t){e._fontSizeWidthRatio||(e._fontSizeWidthRatio=(0,de.default)(e.contentEl)),e.contentStyle.fontSize=e._fontSizeWidthRatio*t.layout.width+"px",e.notify()})}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"fluid-text"}},{key:"behaviorDependencies",get:function(){return["layout"]}}]),t}();fe.default=ye;var me,be={exports:{}};me=function(){function e(e,t){this.id=F++,this.type=e,this.data=t}function t(e){return"["+function e(t){if(0===t.length)return[];var n=t.charAt(0),r=t.charAt(t.length-1);if(1<t.length&&n===r&&('"'===n||"'"===n))return['"'+t.substr(1,t.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t))return e(t.substr(0,n.index)).concat(e(n[1])).concat(e(t.substr(n.index+n[0].length)));if(1===(n=t.split(".")).length)return['"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(t=[],r=0;r<n.length;++r)t=t.concat(e(n[r]));return t}(e).join("][")+"]"}function n(e){return"string"==typeof e?e.split():e}function r(e){return"string"==typeof e?document.querySelector(e):e}function i(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||q(e.data))}function o(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function a(e){var t,n;return t=(65535<e)<<4,t|=n=(255<(e>>>=t))<<3,(t|=n=(15<(e>>>=n))<<2)|(n=(3<(e>>>=n))<<1)|e>>>n>>1}function s(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}return 0<(t=Y[a(e)>>2]).length?t.pop():new ArrayBuffer(e)}function u(e){Y[a(e.byteLength)>>2].push(e)}function l(e,t,n,r,i,o){for(var a=0;a<t;++a)for(var s=e[a],u=0;u<n;++u)for(var l=s[u],c=0;c<r;++c)i[o++]=l[c]}function c(e){return 0|X[Object.prototype.toString.call(e)]}function f(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function h(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var l=0;l<r;++l)e[s++]=t[i*u+o*l+a]}function p(e,t,n){function r(t){this.id=u++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function o(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function a(e,t,n,r,a,s){if(e.usage=n,Array.isArray(t)){if(e.dtype=r||5126,0<t.length)if(Array.isArray(t[0])){a=J(t);for(var u=r=1;u<a.length;++u)r*=a[u];e.dimension=r,o(e,t=Z(t,a,e.dtype),n),s?e.persistentData=t:G.freeType(t)}else"number"==typeof t[0]?(e.dimension=a,f(a=G.allocType(e.dtype,t.length),t),o(e,a,n),s?e.persistentData=a:G.freeType(a)):q(t[0])&&(e.dimension=t[0].length,e.dtype=r||c(t[0])||5126,o(e,t=Z(t,[t.length,t[0].length],e.dtype),n),s?e.persistentData=t:G.freeType(t))}else if(q(t))e.dtype=r||c(t),e.dimension=a,o(e,t,n),s&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(i(t)){a=t.shape;var l=t.stride,p=(u=t.offset,0),d=0,v=0,y=0;1===a.length?(p=a[0],d=1,v=l[0],y=0):2===a.length&&(p=a[0],d=a[1],v=l[0],y=l[1]),e.dtype=r||c(t.data)||5126,e.dimension=d,h(a=G.allocType(e.dtype,p*d),t.data,p,d,v,y,u),o(e,a,n),s?e.persistentData=a:G.freeType(a)}}function s(n){t.bufferCount--,e.deleteBuffer(n.buffer),n.buffer=null,delete l[n.id]}var u=0,l={};r.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){s(this)};var p=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(l).forEach(function(t){e+=l[t].stats.size}),e}),{create:function(o,u,p,d){function v(t){var r=35044,o=null,s=0,u=0,l=1;return Array.isArray(t)||q(t)||i(t)?o=t:"number"==typeof t?s=0|t:t&&("data"in t&&(o=t.data),"usage"in t&&(r=K[t.usage]),"type"in t&&(u=$[t.type]),"dimension"in t&&(l=0|t.dimension),"length"in t&&(s=0|t.length)),y.bind(),o?a(y,o,r,u,l,d):(e.bufferData(y.type,s,r),y.dtype=u||5121,y.usage=r,y.dimension=l,y.byteLength=s),n.profile&&(y.stats.size=y.byteLength*ee[y.dtype]),v}t.bufferCount++;var y=new r(u);return l[y.id]=y,p||v(o),v._reglType="buffer",v._buffer=y,v.subdata=function(t,n){var r,o=0|(n||0);if(y.bind(),q(t))e.bufferSubData(y.type,o,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var a=G.allocType(y.dtype,t.length);f(a,t),e.bufferSubData(y.type,o,a),G.freeType(a)}else(Array.isArray(t[0])||q(t[0]))&&(r=J(t),a=Z(t,r,y.dtype),e.bufferSubData(y.type,o,a),G.freeType(a))}else if(i(t)){r=t.shape;var s=t.stride,u=a=0,l=0,p=0;1===r.length?(a=r[0],u=1,l=s[0],p=0):2===r.length&&(a=r[0],u=r[1],l=s[0],p=s[1]),r=Array.isArray(t.data)?y.dtype:c(t.data),h(r=G.allocType(r,a*u),t.data,a,u,l,p,t.offset),e.bufferSubData(y.type,o,r),G.freeType(r)}return v},n.profile&&(v.stats=y.stats),v.destroy=function(){s(y)},v},createStream:function(e,t){var n=p.pop();return n||(n=new r(e)),n.bind(),a(n,t,35040,0,1,!1),n},destroyStream:function(e){p.push(e)},clear:function(){U(l).forEach(s),p.forEach(s)},getBuffer:function(e){return e&&e._buffer instanceof r?e._buffer:null},restore:function(){U(l).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:a}}function d(e,t,n,r){function o(e){this.id=l++,u[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function a(r,o,a,s,u,l,c){if(r.buffer.bind(),o){var f=c;c||q(o)&&(!i(o)||q(o.data))||(f=t.oes_element_index_uint?5125:5123),n._initBuffer(r.buffer,o,a,f,3)}else e.bufferData(34963,l,a),r.buffer.dtype=f||5121,r.buffer.usage=a,r.buffer.dimension=3,r.buffer.byteLength=l;if(f=c,!c){switch(r.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;break;case 5125:case 5124:f=5125}r.buffer.dtype=f}r.type=f,0>(o=u)&&(o=r.buffer.byteLength,5123===f?o>>=1:5125===f&&(o>>=2)),r.vertCount=o,o=s,0>s&&(o=4,1===(s=r.buffer.dimension)&&(o=0),2===s&&(o=1),3===s&&(o=4)),r.primType=o}function s(e){r.elementsCount--,delete u[e.id],e.buffer.destroy(),e.buffer=null}var u={},l=0,c={uint8:5121,uint16:5123};t.oes_element_index_uint&&(c.uint32=5125),o.prototype.bind=function(){this.buffer.bind()};var f=[];return{create:function(e,t){function u(e){if(e)if("number"==typeof e)l(e),f.primType=4,f.vertCount=0|e,f.type=5121;else{var t=null,n=35044,r=-1,o=-1,s=0,h=0;Array.isArray(e)||q(e)||i(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=K[e.usage]),"primitive"in e&&(r=te[e.primitive]),"count"in e&&(o=0|e.count),"type"in e&&(h=c[e.type]),"length"in e?s=0|e.length:(s=o,5123===h||5122===h?s*=2:5125!==h&&5124!==h||(s*=4))),a(f,t,n,r,o,s,h)}else l(),f.primType=4,f.vertCount=0,f.type=5121;return u}var l=n.create(null,34963,!0),f=new o(l._buffer);return r.elementsCount++,u(e),u._reglType="elements",u._elements=f,u.subdata=function(e,t){return l.subdata(e,t),u},u.destroy=function(){s(f)},u},createStream:function(e){var t=f.pop();return t||(t=new o(n.create(null,34963,!0,!1)._buffer)),a(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){f.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof o?e._elements:null},clear:function(){U(u).forEach(s)}}}function v(e){for(var t=G.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(1/0===e[n])t[n]=31744;else if(-1/0===e[n])t[n]=64512;else{ne[0]=e[n];var r=(o=re[0])>>>31<<15,i=(o<<1>>>24)-127,o=o>>13&1023;t[n]=-24>i?r:-14>i?r+(o+1024>>-14-i):15<i?r+31744:r+(i+15<<10)+o}return t}function y(e){return Array.isArray(e)||q(e)}function m(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function b(e){return!(!Array.isArray(e)||0===e.length||!y(e[0]))}function g(e){return Object.prototype.toString.call(e)}function _(e){if(!e)return!1;var t=g(e);return 0<=se.indexOf(t)||m(e)||b(e)||i(e)}function w(e,t){36193===e.type?(e.data=v(t),G.freeType(t)):e.data=t}function x(e,t,n,r,i,o){if(e=void 0!==le[e]?le[e]:ae[e]*ue[t],o&&(e*=6),i){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}function T(e,t,n,r,o,a,s){function u(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function l(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function c(e,t){if("object"==typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=W[t.colorSpace]),"type"in t&&(e.type=V[t.type]);var n=e.width,r=e.height,i=e.channels,o=!1;"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(i=t.shape[2],o=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(i=t.channels,o=!0)),e.width=0|n,e.height=0|r,e.channels=0|i,n=!1,"format"in t&&(n=t.format,r=e.internalformat=Y[n],e.format=se[r],n in V&&!("type"in t)&&(e.type=V[n]),n in $&&(e.compressed=!0),n=!0),!o&&n?e.channels=ae[e.format]:o&&!n&&e.channels!==oe[e.format]&&(e.format=e.internalformat=oe[e.channels])}}function f(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function h(){u.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function p(e,t){var n=null;if(_(t)?n=t:t&&(c(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),_(t.data)&&(n=t.data)),t.copy){var r=o.viewportWidth,a=o.viewportHeight;e.width=e.width||r-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0}else if(n){if(q(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|X[Object.prototype.toString.call(n)]);else if(m(n)){switch(e.channels=e.channels||4,a=(r=n).length,e.type){case 5121:case 5123:case 5125:case 5126:(a=G.allocType(e.type,a)).set(r),e.data=a;break;case 36193:e.data=v(r)}e.alignment=1,e.needsFree=!0}else if(i(n)){r=n.data,Array.isArray(r)||5121!==e.type||(e.type=0|X[Object.prototype.toString.call(r)]),a=n.shape;var s,u,l,f,h=n.stride;3===a.length?(l=a[2],f=h[2]):f=l=1,s=a[0],u=a[1],a=h[0],h=h[1],e.alignment=1,e.width=s,e.height=u,e.channels=l,e.format=e.internalformat=oe[l],e.needsFree=!0,s=f,n=n.offset,l=e.width,f=e.height,u=e.channels;for(var p=G.allocType(36193===e.type?5126:e.type,l*f*u),d=0,x=0;x<f;++x)for(var T=0;T<l;++T)for(var O=0;O<u;++O)p[d++]=r[a*T+h*x+s*O+n];w(e,p)}else if("[object HTMLCanvasElement]"===g(n)||"[object CanvasRenderingContext2D]"===g(n))"[object HTMLCanvasElement]"===g(n)?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if("[object HTMLImageElement]"===g(n))e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if("[object HTMLVideoElement]"===g(n))e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(b(n)){for(r=e.width||n[0].length,a=e.height||n.length,h=e.channels,h=y(n[0][0])?h||n[0][0].length:h||1,s=Q.shape(n),l=1,f=0;f<s.length;++f)l*=s[f];l=G.allocType(36193===e.type?5126:e.type,l),Q.flatten(n,s,"",l),w(e,l),e.alignment=1,e.width=r,e.height=a,e.channels=h,e.format=e.internalformat=oe[h],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function d(t,n,i,o,a){var s=t.element,u=t.data,l=t.internalformat,c=t.format,h=t.type,p=t.width,d=t.height;f(t),s?e.texSubImage2D(n,a,i,o,c,h,s):t.compressed?e.compressedTexSubImage2D(n,a,i,o,l,p,d,u):t.needsCopy?(r(),e.copyTexSubImage2D(n,a,i,o,t.xOffset,t.yOffset,p,d)):e.texSubImage2D(n,a,i,o,p,d,c,h,u)}function T(){return ue.pop()||new h}function O(e){e.needsFree&&G.freeType(e.data),h.call(e),ue.push(e)}function E(e,t,n){var r=e.images[0]=T();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function k(e,t){var n=null;if(_(t))l(n=e.images[0]=T(),e),p(n,t),e.mipmask=1;else if(c(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)l(n=e.images[i]=T(),e),n.width>>=i,n.height>>=i,p(n,r[i]),e.mipmask|=1<<i;else l(n=e.images[0]=T(),e),p(n,t),e.mipmask=1;l(e,e.images[0])}function S(t,n){for(var i=t.images,o=0;o<i.length&&i[o];++o){var a=i[o],s=n,u=o,l=a.element,c=a.data,h=a.internalformat,p=a.format,d=a.type,v=a.width,y=a.height;f(a),l?e.texImage2D(s,u,p,p,d,l):a.compressed?e.compressedTexImage2D(s,u,h,v,y,0,c):a.needsCopy?(r(),e.copyTexImage2D(s,u,p,a.xOffset,a.yOffset,v,y,0)):e.texImage2D(s,u,p,v,y,0,p,d,c)}}function M(){var e=le.pop()||new function(){u.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)};u.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function P(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&O(t[n]),t[n]=null;le.push(e)}function j(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function A(e,t){"min"in t&&(e.minFilter=z[t.min],0<=ie.indexOf(e.minFilter)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=F[t.mag]);var n=e.wrapS,r=e.wrapT;if("wrap"in t){var i=t.wrap;"string"==typeof i?n=r=R[i]:Array.isArray(i)&&(n=R[i[0]],r=R[i[1]])}else"wrapS"in t&&(n=R[t.wrapS]),"wrapT"in t&&(r=R[t.wrapT]);if(e.wrapS=n,e.wrapT=r,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(n=!1,typeof t.mipmap){case"string":e.mipmapHint=N[t.mipmap],n=e.genMipmaps=!0;break;case"boolean":n=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,n=!0}!n||"min"in t||(e.minFilter=9984)}}function C(n,r){e.texParameteri(r,10241,n.minFilter),e.texParameteri(r,10240,n.magFilter),e.texParameteri(r,10242,n.wrapS),e.texParameteri(r,10243,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(e.hint(33170,n.mipmapHint),e.generateMipmap(r))}function D(t){u.call(this),this.mipmask=0,this.internalformat=6408,this.id=ce++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new j,s.profile&&(this.stats={size:0})}function L(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function H(){var t=pe[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function B(t){var n=t.texture,r=t.unit,i=t.target;0<=r&&(e.activeTexture(33984+r),e.bindTexture(i,null),pe[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete fe[t.id],a.textureCount--}var N={"don't care":4352,"dont care":4352,nice:4354,fast:4353},R={repeat:10497,clamp:33071,mirror:33648},F={nearest:9728,linear:9729},z=I({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},F),W={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},$={};t.ext_srgb&&(Y.srgb=35904,Y.srgba=35906),t.oes_texture_float&&(V.float32=V.float=5126),t.oes_texture_half_float&&(V.float16=V["half float"]=36193),t.webgl_depth_texture&&(I(Y,{depth:6402,"depth stencil":34041}),I(V,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&I($,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&I($,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&I($,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&($["rgb etc1"]=36196);var K=Array.prototype.slice.call(e.getParameter(34467));Object.keys($).forEach(function(e){var t=$[e];0<=K.indexOf(t)&&(Y[e]=t)});var Z=Object.keys(Y);n.textureFormats=Z;var J=[];Object.keys(Y).forEach(function(e){J[Y[e]]=e});var ee=[];Object.keys(V).forEach(function(e){ee[V[e]]=e});var te=[];Object.keys(F).forEach(function(e){te[F[e]]=e});var ne=[];Object.keys(z).forEach(function(e){ne[z[e]]=e});var re=[];Object.keys(R).forEach(function(e){re[R[e]]=e});var se=Z.reduce(function(e,t){var n=Y[t];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n?e[n]=n:32855===n||0<=t.indexOf("rgba")?e[n]=6408:e[n]=6407,e},{}),ue=[],le=[],ce=0,fe={},he=n.maxTextureUnits,pe=Array(he).map(function(){return null});return I(D.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var n=0;n<he;++n){var r=pe[n];if(r){if(0<r.bindCount)continue;r.unit=-1}pe[n]=this,t=n;break}s.profile&&a.maxTextureUnits<t+1&&(a.maxTextureUnits=t+1),this.unit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&B(this)}}),s.profile&&(a.getTotalTextureSize=function(){var e=0;return Object.keys(fe).forEach(function(t){e+=fe[t].stats.size}),e}),{create2D:function(t,n){function r(e,t){var n=i.texInfo;j.call(n);var o=M();return"number"==typeof e?E(o,0|e,"number"==typeof t?0|t:0|e):e?(A(n,e),k(o,e)):E(o,1,1),n.genMipmaps&&(o.mipmask=(o.width<<1)-1),i.mipmask=o.mipmask,l(i,o),i.internalformat=o.internalformat,r.width=o.width,r.height=o.height,L(i),S(o,3553),C(n,3553),H(),P(o),s.profile&&(i.stats.size=x(i.internalformat,i.type,o.width,o.height,n.genMipmaps,!1)),r.format=J[i.internalformat],r.type=ee[i.type],r.mag=te[n.magFilter],r.min=ne[n.minFilter],r.wrapS=re[n.wrapS],r.wrapT=re[n.wrapT],r}var i=new D(3553);return fe[i.id]=i,a.textureCount++,r(t,n),r.subimage=function(e,t,n,o){t|=0,n|=0,o|=0;var a=T();return l(a,i),a.width=0,a.height=0,p(a,e),a.width=a.width||(i.width>>o)-t,a.height=a.height||(i.height>>o)-n,L(i),d(a,3553,t,n,o),H(),O(a),r},r.resize=function(t,n){var o=0|t,a=0|n||o;if(o===i.width&&a===i.height)return r;r.width=i.width=o,r.height=i.height=a,L(i);for(var u=0;i.mipmask>>u;++u)e.texImage2D(3553,u,i.format,o>>u,a>>u,0,i.format,i.type,null);return H(),s.profile&&(i.stats.size=x(i.internalformat,i.type,o,a,!1,!1)),r},r._reglType="texture2d",r._texture=i,s.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},createCube:function(t,n,r,i,o,u){function f(e,t,n,r,i,o){var a,u=h.texInfo;for(j.call(u),a=0;6>a;++a)v[a]=M();if("number"!=typeof e&&e){if("object"==typeof e)if(t)k(v[0],e),k(v[1],t),k(v[2],n),k(v[3],r),k(v[4],i),k(v[5],o);else if(A(u,e),c(h,e),"faces"in e)for(e=e.faces,a=0;6>a;++a)l(v[a],h),k(v[a],e[a]);else for(a=0;6>a;++a)k(v[a],e)}else for(e=0|e||1,a=0;6>a;++a)E(v[a],e,e);for(l(h,v[0]),h.mipmask=u.genMipmaps?(v[0].width<<1)-1:v[0].mipmask,h.internalformat=v[0].internalformat,f.width=v[0].width,f.height=v[0].height,L(h),a=0;6>a;++a)S(v[a],34069+a);for(C(u,34067),H(),s.profile&&(h.stats.size=x(h.internalformat,h.type,f.width,f.height,u.genMipmaps,!0)),f.format=J[h.internalformat],f.type=ee[h.type],f.mag=te[u.magFilter],f.min=ne[u.minFilter],f.wrapS=re[u.wrapS],f.wrapT=re[u.wrapT],a=0;6>a;++a)P(v[a]);return f}var h=new D(34067);fe[h.id]=h,a.cubeCount++;var v=Array(6);return f(t,n,r,i,o,u),f.subimage=function(e,t,n,r,i){n|=0,r|=0,i|=0;var o=T();return l(o,h),o.width=0,o.height=0,p(o,t),o.width=o.width||(h.width>>i)-n,o.height=o.height||(h.height>>i)-r,L(h),d(o,34069+e,n,r,i),H(),O(o),f},f.resize=function(t){if((t|=0)!==h.width){f.width=h.width=t,f.height=h.height=t,L(h);for(var n=0;6>n;++n)for(var r=0;h.mipmask>>r;++r)e.texImage2D(34069+n,r,h.format,t>>r,t>>r,0,h.format,h.type,null);return H(),s.profile&&(h.stats.size=x(h.internalformat,h.type,f.width,f.height,!1,!0)),f}},f._reglType="textureCube",f._texture=h,s.profile&&(f.stats=h.stats),f.destroy=function(){h.decRef()},f},clear:function(){for(var t=0;t<he;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),pe[t]=null;U(fe).forEach(B),a.cubeCount=0,a.textureCount=0},getTexture:function(e){return null},restore:function(){U(fe).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;32>n;++n)if(0!=(t.mipmask&1<<n))if(3553===t.target)e.texImage2D(3553,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;6>r;++r)e.texImage2D(34069+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);C(t.texInfo,t.target)})}}}function O(e,t,n,r,i,o){function a(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function u(e,t,n){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function l(t,n){n&&(n.texture?e.framebufferTexture2D(36160,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,n.renderbuffer._renderbuffer.renderbuffer))}function c(e){var t=3553,n=null,r=null,i=e;return"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),"texture2d"===(e=i._reglType)?n=i:"textureCube"===e?n=i:"renderbuffer"===e&&(r=i,t=36161),new a(t,n,r)}function f(e,t,n,o,s){return n?((e=r.create2D({width:e,height:t,format:o,type:s}))._texture.refCount=0,new a(3553,e,null)):((e=i.create({width:e,height:t,format:o}))._renderbuffer.refCount=0,new a(36161,null,e))}function h(e){return e&&(e.texture||e.renderbuffer)}function p(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function d(){this.id=T++,O[this.id]=this,this.framebuffer=e.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function y(t){e.deleteFramebuffer(t.framebuffer),t.framebuffer=null,o.framebufferCount--,delete O[t.id]}function m(t){var r;e.bindFramebuffer(36160,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)l(36064+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(36160,36064+r,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),l(36096,t.depthAttachment),l(36128,t.stencilAttachment),l(33306,t.depthStencilAttachment),e.checkFramebufferStatus(36160),e.bindFramebuffer(36160,g.next),g.cur=g.next,e.getError()}function b(e,t){function n(e,t){var i,o=0,a=0,s=!0,l=!0;i=null;var p=!0,d="rgba",y="uint8",b=1,g=null,x=null,T=null,O=!1;"number"==typeof e?(o=0|e,a=0|t||o):e?("shape"in e?(o=(a=e.shape)[0],a=a[1]):("radius"in e&&(o=a=e.radius),"width"in e&&(o=e.width),"height"in e&&(a=e.height)),("color"in e||"colors"in e)&&(i=e.color||e.colors,Array.isArray(i)),i||("colorCount"in e&&(b=0|e.colorCount),"colorTexture"in e&&(p=!!e.colorTexture,d="rgba4"),"colorType"in e&&(y=e.colorType,!p)&&("half float"===y||"float16"===y?d="rgba16f":"float"!==y&&"float32"!==y||(d="rgba32f")),"colorFormat"in e&&(d=e.colorFormat,0<=_.indexOf(d)?p=!0:0<=w.indexOf(d)&&(p=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(O=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(g=e.depth,l=!1)),"stencil"in e&&("boolean"==typeof e.stencil?l=e.stencil:(x=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=l=e.depthStencil:(T=e.depthStencil,l=s=!1))):o=a=1;var E=null,k=null,S=null,M=null;if(Array.isArray(i))E=i.map(c);else if(i)E=[c(i)];else for(E=Array(b),i=0;i<b;++i)E[i]=f(o,a,p,d,y);for(o=o||E[0].width,a=a||E[0].height,g?k=c(g):s&&!l&&(k=f(o,a,O,"depth","uint32")),x?S=c(x):l&&!s&&(S=f(o,a,!1,"stencil","uint8")),T?M=c(T):!g&&!x&&l&&s&&(M=f(o,a,O,"depth stencil","depth stencil")),s=null,i=0;i<E.length;++i)u(E[i]),E[i]&&E[i].texture&&(l=he[E[i].texture._texture.format]*pe[E[i].texture._texture.type],null===s&&(s=l));return u(k),u(S),u(M),v(r),r.width=o,r.height=a,r.colorAttachments=E,r.depthAttachment=k,r.stencilAttachment=S,r.depthStencilAttachment=M,n.color=E.map(h),n.depth=h(k),n.stencil=h(S),n.depthStencil=h(M),n.width=r.width,n.height=r.height,m(r),n}var r=new d;return o.framebufferCount++,n(e,t),I(n,{resize:function(e,t){var i=0|e,o=0|t||i;if(i===r.width&&o===r.height)return n;for(var a=r.colorAttachments,s=0;s<a.length;++s)p(a[s],i,o);return p(r.depthAttachment,i,o),p(r.stencilAttachment,i,o),p(r.depthStencilAttachment,i,o),r.width=n.width=i,r.height=n.height=o,m(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){y(r),v(r)},use:function(e){g.setFBO({framebuffer:n},e)}})}var g={cur:null,next:null,dirty:!1,setFBO:null},_=["rgba"],w=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&w.push("srgba"),t.ext_color_buffer_half_float&&w.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&w.push("rgba32f");var x=["uint8"];t.oes_texture_half_float&&x.push("half float","float16"),t.oes_texture_float&&x.push("float","float32");var T=0,O={};return I(g,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer)instanceof d?e:null},create:b,createCube:function(e){function t(e){var i,o={color:null},a=0,s=null;i="rgba";var u="uint8",l=1;if("number"==typeof e?a=0|e:e?("shape"in e?a=e.shape[0]:("radius"in e&&(a=0|e.radius),"width"in e?a=0|e.width:"height"in e&&(a=0|e.height)),("color"in e||"colors"in e)&&(s=e.color||e.colors,Array.isArray(s)),s||("colorCount"in e&&(l=0|e.colorCount),"colorType"in e&&(u=e.colorType),"colorFormat"in e&&(i=e.colorFormat)),"depth"in e&&(o.depth=e.depth),"stencil"in e&&(o.stencil=e.stencil),"depthStencil"in e&&(o.depthStencil=e.depthStencil)):a=1,s)if(Array.isArray(s))for(e=[],i=0;i<s.length;++i)e[i]=s[i];else e=[s];else for(e=Array(l),s={radius:a,format:i,type:u},i=0;i<l;++i)e[i]=r.createCube(s);for(o.color=Array(e.length),i=0;i<e.length;++i)l=e[i],a=a||l.width,o.color[i]={target:34069,data:e[i]};for(i=0;6>i;++i){for(l=0;l<e.length;++l)o.color[l].target=34069+i;0<i&&(o.depth=n[0].depth,o.stencil=n[0].stencil,o.depthStencil=n[0].depthStencil),n[i]?n[i](o):n[i]=b(o)}return I(t,{width:a,height:a,color:e})}var n=Array(6);return t(e),I(t,{faces:n,resize:function(e){var r=0|e;if(r===t.width)return t;var i=t.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;6>e;++e)n[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){n.forEach(function(e){e.destroy()})}})},clear:function(){U(O).forEach(y)},restore:function(){U(O).forEach(function(t){t.framebuffer=e.createFramebuffer(),m(t)})}})}function E(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function k(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){if(!(a=(i=35632===n?l:c)[r])){var o=t.str(r),a=e.createShader(n);e.shaderSource(a,o),e.compileShader(a),i[r]=a}return a}function s(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(n,s){var u,l;u=a(35632,n.fragId),l=a(35633,n.vertId);var c=n.program=e.createProgram();e.attachShader(c,u),e.attachShader(c,l),e.linkProgram(c);var f=e.getProgramParameter(c,35718);r.profile&&(n.stats.uniformsCount=f);var h=n.uniforms;for(u=0;u<f;++u)if(l=e.getActiveUniform(c,u))if(1<l.size)for(var p=0;p<l.size;++p){var d=l.name.replace("[0]","["+p+"]");o(h,new i(d,t.id(d),e.getUniformLocation(c,d),l))}else o(h,new i(l.name,t.id(l.name),e.getUniformLocation(c,l.name),l));for(f=e.getProgramParameter(c,35721),r.profile&&(n.stats.attributesCount=f),h=n.attributes,u=0;u<f;++u)(l=e.getActiveAttrib(c,u))&&o(h,new i(l.name,t.id(l.name),e.getAttribLocation(c,l.name),l))}var l={},c={},f={},h=[],p=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);U(l).forEach(t),l={},U(c).forEach(t),c={},h.forEach(function(t){e.deleteProgram(t.program)}),h.length=0,f={},n.shaderCount=0},program:function(e,t,r){var i=f[t];i||(i=f[t]={});var o=i[e];return o||(o=new s(t,e),n.shaderCount++,u(o),i[e]=o,h.push(o)),o},restore:function(){l={},c={};for(var e=0;e<h.length;++e)u(h[e])},shader:a,frag:-1,vert:-1}}function S(e,t,n,r,i,o){function a(i){var o;o=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var a=0,s=0,u=r.framebufferWidth,l=r.framebufferHeight,c=null;return q(i)?c=i:i&&(a=0|i.x,s=0|i.y,u=0|(i.width||r.framebufferWidth-a),l=0|(i.height||r.framebufferHeight-s),c=i.data||null),n(),i=u*l*4,c||(5121===o?c=new Uint8Array(i):5126===o&&(c=c||new Float32Array(i))),e.pixelStorei(3333,4),e.readPixels(a,s,u,l,6408,o,c),c}return function(e){return e&&"framebuffer"in e?function(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=a(e)}),n}(e):a(e)}}function M(e){return Array.prototype.slice.call(e)}function P(e){return M(e).join("")}function j(){function e(){var e=[],t=[];return I(function(){e.push.apply(e,M(arguments))},{def:function(){var r="v"+n++;return t.push(r),0<arguments.length&&(e.push(r,"="),e.push.apply(e,M(arguments)),e.push(";")),r},toString:function(){return P([0<t.length?"var "+t+";":"",P(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),i=n.toString,o=r.toString;return I(function(){n.apply(n,M(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,i){t(e,r),n(e,r,"=",i,";")},toString:function(){return i()+o()}})}var n=0,r=[],i=[],o=e(),a={};return{global:o,link:function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return r[t];return t="g"+n++,r.push(t),i.push(e),t},block:e,proc:function(e,n){function r(){var e="a"+i.length;return i.push(e),e}var i=[];n=n||0;for(var o=0;o<n;++o)r();var s=(o=t()).toString;return a[e]=I(o,{arg:r,toString:function(){return P(["function(",i.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=P(arguments),n=t(),r=t(),i=n.toString,o=r.toString;return I(n,{then:function(){return n.apply(n,M(arguments)),this},else:function(){return r.apply(r,M(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),P(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',o,"return {"];Object.keys(a).forEach(function(t){e.push('"',t,'":',a[t].toString(),",")}),e.push("}");var t=P(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,i)}}}function A(e){return Array.isArray(e)||q(e)||i(e)}function C(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function D(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function L(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function H(e){return new D(!1,!1,!1,e)}function B(e,t){var n=e.type;return 0===n?new D(!0,1<=(n=e.data.length),2<=n,t):4===n?new D((n=e.data).thisDep,n.contextDep,n.propDep,t):new D(3===n,2===n,1===n,t)}function N(e,t,n,r,i,a,s,u,l,c,f,h,p,d,v){function m(e){return e.replace(".","_")}function b(e,t,n){var r=m(e);ne.push(e),ee[r]=J[r]=!!n,re[r]=t}function g(e,t,n){var r=m(e);ne.push(e),Array.isArray(n)?(J[r]=n.slice(),ee[r]=n.slice()):J[r]=ee[r]=n,ie[r]=t}function _(){var e=j(),n=e.link,r=e.global;e.id=se++,e.batchId="0";var i=n(oe),o=e.shared={props:"a0"};Object.keys(oe).forEach(function(e){o[e]=r.def(i,".",e)});var a=e.next={},s=e.current={};Object.keys(ie).forEach(function(e){Array.isArray(J[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))});var u=e.constants={};Object.keys(ae).forEach(function(e){u[e]=r.def(JSON.stringify(ae[e]))}),e.invoke=function(t,r){switch(r.type){case 0:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case 1:return t.def(o.props,r.data);case 2:return t.def(o.context,r.data);case 3:return t.def("this",r.data);case 4:return r.data.append(e,t),r.data.ref}},e.attribCache={};var l={};return e.scopeAttrib=function(e){if((e=t.id(e))in l)return l[e];var r=c.scope[e];return r||(r=c.scope[e]=new Q),l[e]=n(r)},e}function w(e,t){var n=e.static,r=e.dynamic;if("framebuffer"in n){var i=n.framebuffer;return i?(i=u.getFramebuffer(i),H(function(e,t){var n=e.link(i),r=e.shared;return t.set(r.framebuffer,".next",n),r=r.context,t.set(r,".framebufferWidth",n+".width"),t.set(r,".framebufferHeight",n+".height"),n})):H(function(e,t){var n=e.shared;return t.set(n.framebuffer,".next","null"),n=n.context,t.set(n,".framebufferWidth",n+".drawingBufferWidth"),t.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var o=r.framebuffer;return B(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer;return n=t.def(i,".getFramebuffer(",n,")"),t.set(i,".next",n),r=r.context,t.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}function x(e){function n(e){if(e in r){var n=t.id(r[e]);return(e=H(function(){return n})).id=n,e}if(e in i){var o=i[e];return B(o,function(e,t){var n=e.invoke(t,o);return t.def(e.shared.strings,".id(",n,")")})}return null}var r=e.static,i=e.dynamic,o=n("frag"),a=n("vert"),s=null;return L(o)&&L(a)?(s=f.program(a.id,o.id),e=H(function(e,t){return e.link(s)})):e=new D(o&&o.thisDep||a&&a.thisDep,o&&o.contextDep||a&&a.contextDep,o&&o.propDep||a&&a.propDep,function(e,t){var n,r,i=e.shared.shader;return n=o?o.append(e,t):t.def(i,".","frag"),r=a?a.append(e,t):t.def(i,".","vert"),t.def(i+".program("+r+","+n+")")}),{frag:o,vert:a,progVar:e,program:s}}function T(e,t){function n(e,t){if(e in r){var n=0|r[e];return H(function(e,r){return t&&(e.OFFSET=n),n})}if(e in i){var a=i[e];return B(a,function(e,n){var r=e.invoke(n,a);return t&&(e.OFFSET=r),r})}return t&&o?H(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,i=e.dynamic,o=function(){if("elements"in r){var e=r.elements;A(e)?e=a.getElements(a.create(e,!0)):e&&(e=a.getElements(e));var t=H(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r}return t.ELEMENTS=null});return t.value=e,t}if("elements"in i){var n=i.elements;return B(n,function(e,t){var r=(i=e.shared).isBufferArgs,i=i.elements,o=e.invoke(t,n),a=t.def("null");return r=t.def(r,"(",o,")"),o=e.cond(r).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");"),t.entry(o),t.exit(e.cond(r).then(i,".destroyStream(",a,");")),e.ELEMENTS=a})}return null}(),s=n("offset",!0);return{elements:o,primitive:function(){if("primitive"in r){var e=r.primitive;return H(function(t,n){return te[e]})}if("primitive"in i){var t=i.primitive;return B(t,function(e,n){var r=e.constants.primTypes,i=e.invoke(n,t);return n.def(r,"[",i,"]")})}return o?L(o)?o.value?H(function(e,t){return t.def(e.ELEMENTS,".primType")}):H(function(){return 4}):new D(o.thisDep,o.contextDep,o.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in r){var e=0|r.count;return H(function(){return e})}if("count"in i){var t=i.count;return B(t,function(e,n){return e.invoke(n,t)})}return o?L(o)?o?s?new D(s.thisDep,s.contextDep,s.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):H(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):H(function(){return-1}):new D(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):null}(),instances:n("instances",!1),offset:s}}function O(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach(function(e){var n=r[e],o=t.id(e),s=new Q;if(A(n))s.state=1,s.buffer=i.getBuffer(i.create(n,34962,!1,!0)),s.type=0;else if(l=i.getBuffer(n))s.state=1,s.buffer=l,s.type=0;else if(n.constant){var u=n.constant;s.buffer="null",s.state=2,"number"==typeof u?s.x=u:de.forEach(function(e,t){t<u.length&&(s[e]=u[t])})}else{var l=A(n.buffer)?i.getBuffer(i.create(n.buffer,34962,!1,!0)):i.getBuffer(n.buffer),c=0|n.offset,f=0|n.stride,h=0|n.size,p=!!n.normalized,d=0;"type"in n&&(d=$[n.type]),n=0|n.divisor,s.buffer=l,s.state=1,s.size=h,s.normalized=p,s.type=d||l.dtype,s.offset=c,s.stride=f,s.divisor=n}a[e]=H(function(e,t){var n=e.attribCache;if(o in n)return n[o];var r={isStream:!1};return Object.keys(s).forEach(function(e){r[e]=s[e]}),s.buffer&&(r.buffer=e.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[o]=r})}),Object.keys(o).forEach(function(e){var t=o[e];a[e]=B(t,function(e,n){function r(e){n(u[e],"=",i,".",e,"|0;")}var i=e.invoke(n,t),o=e.shared,a=o.isBufferArgs,s=o.buffer,u={isStream:n.def(!1)},l=new Q;l.state=1,Object.keys(l).forEach(function(e){u[e]=n.def(""+l[e])});var c=u.buffer,f=u.type;return n("if(",a,"(",i,")){",u.isStream,"=true;",c,"=",s,".createStream(",34962,",",i,");",f,"=",c,".dtype;","}else{",c,"=",s,".getBuffer(",i,");","if(",c,"){",f,"=",c,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",2,";","if(typeof "+i+'.constant === "number"){',u[de[0]],"=",i,".constant;",de.slice(1).map(function(e){return u[e]}).join("="),"=0;","}else{",de.map(function(e,t){return u[e]+"="+i+".constant.length>="+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",a,"(",i,".buffer)){",c,"=",s,".createStream(",34962,",",i,".buffer);","}else{",c,"=",s,".getBuffer(",i,".buffer);","}",f,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",c,".dtype;",u.normalized,"=!!",i,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",u.isStream,"){",s,".destroyStream(",c,");","}"),u})}),a}function E(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(o){t.save(r,"."+o),i(r,".",o,"=",n[o].append(e,t),";")}),t(i)}function k(e,t,n,r){var i,o=(s=e.shared).gl,a=s.framebuffer;Z&&(i=t.def(s.extensions,".webgl_draw_buffers"));var s=(u=e.constants).drawBuffer,u=u.backBuffer;e=n?n.append(e,t):t.def(a,".next"),r||t("if(",e,"!==",a,".cur){"),t("if(",e,"){",o,".bindFramebuffer(",36160,",",e,".framebuffer);"),Z&&t(i,".drawBuffersWEBGL(",s,"[",e,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",36160,",null);"),Z&&t(i,".drawBuffersWEBGL(",u,");"),t("}",a,".cur=",e,";"),r||t("}")}function S(e,t,n){var r=e.shared,i=r.gl,a=e.current,s=e.next,u=r.current,l=r.next,c=e.cond(u,".dirty");ne.forEach(function(t){var r,f;if(!((t=m(t))in n.state))if(t in s){r=s[t],f=a[t];var h=o(J[t].length,function(e){return c.def(r,"[",e,"]")});c(e.cond(h.map(function(e,t){return e+"!=="+f+"["+t+"]"}).join("||")).then(i,".",ie[t],"(",h,");",h.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";"))}else r=c.def(l,".",t),h=e.cond(r,"!==",u,".",t),c(h),t in re?h(e.cond(r).then(i,".enable(",re[t],");").else(i,".disable(",re[t],");"),u,".",t,"=",r,";"):h(i,".",ie[t],"(",r,");",u,".",t,"=",r,";")}),0===Object.keys(n.state).length&&c(u,".dirty=false;"),t(c)}function M(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;C(Object.keys(n)).forEach(function(i){var u=n[i];if(!r||r(u)){var l=u.append(e,t);if(re[i]){var c=re[i];L(u)?t(s,l?".enable(":".disable(",c,");"):t(e.cond(l).then(s,".enable(",c,");").else(s,".disable(",c,");")),t(a,".",i,"=",l,";")}else if(y(l)){var f=o[i];t(s,".",ie[i],"(",l,");",l.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";")}else t(s,".",ie[i],"(",l,");",a,".",i,"=",l,";")}})}function P(e,t){K&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function N(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){e(l=t.def(),"=",o(),";"),"string"==typeof i?e(h,".count+=",i,";"):e(h,".count++;"),d&&(r?e(c=t.def(),"=",v,".getNumPendingQueries();"):e(v,".beginQuery(",h,");"))}function s(e){e(h,".cpuTime+=",o(),"-",l,";"),d&&(r?e(v,".pushScopeStats(",c,",",v,".getNumPendingQueries(),",h,");"):e(v,".endQuery();"))}function u(e){var n=t.def(p,".profile");t(p,".profile=",e,";"),t.exit(p,".profile=",n,";")}var l,c,f=e.shared,h=e.stats,p=f.current,v=f.timer;if(n=n.profile){if(L(n))return void(n.enable?(a(t),s(t.exit),u("true")):u("false"));u(n=n.append(e,t))}else n=t.def(p,".profile");a(f=e.block()),t("if(",n,"){",f,"}"),s(e=e.block()),t.exit("if(",n,"){",e,"}")}function R(e,t,n,r,i){function o(n,r,i){function o(){t("if(!",c,".buffer){",u,".enableVertexAttribArray(",l,");}");var n,o=i.type;n=i.size?t.def(i.size,"||",r):r,t("if(",c,".type!==",o,"||",c,".size!==",n,"||",p.map(function(e){return c+"."+e+"!=="+i[e]}).join("||"),"){",u,".bindBuffer(",34962,",",f,".buffer);",u,".vertexAttribPointer(",[l,n,o,i.normalized,i.stride,i.offset],");",c,".type=",o,";",c,".size=",n,";",p.map(function(e){return c+"."+e+"="+i[e]+";"}).join(""),"}"),K&&(o=i.divisor,t("if(",c,".divisor!==",o,"){",e.instancing,".vertexAttribDivisorANGLE(",[l,o],");",c,".divisor=",o,";}"))}function s(){t("if(",c,".buffer){",u,".disableVertexAttribArray(",l,");","}if(",de.map(function(e,t){return c+"."+e+"!=="+h[t]}).join("||"),"){",u,".vertexAttrib4f(",l,",",h,");",de.map(function(e,t){return c+"."+e+"="+h[t]+";"}).join(""),"}")}var u=a.gl,l=t.def(n,".location"),c=t.def(a.attributes,"[",l,"]");n=i.state;var f=i.buffer,h=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];1===n?o():2===n?s():(t("if(",n,"===",1,"){"),o(),t("}else{"),s(),t("}"))}var a=e.shared;r.forEach(function(r){var a,s=r.name,u=n.attributes[s];if(u){if(!i(u))return;a=u.append(e,t)}else{if(!i(_e))return;var l=e.scopeAttrib(s);a={},Object.keys(new Q).forEach(function(e){a[e]=t.def(l,".",e)})}o(e.link(r),function(e){switch(r.info.type){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(),a)})}function I(e,n,r,i,a){for(var s,u=e.shared,l=u.gl,c=0;c<i.length;++c){var f,h=(v=i[c]).name,p=v.info.type,d=r.uniforms[h],v=e.link(v)+".location";if(d){if(!a(d))continue;if(L(d)){if(h=d.value,35678===p||35680===p)n(l,".uniform1i(",v,",",(p=e.link(h._texture||h.color[0]._texture))+".bind());"),n.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)h=e.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),d=2,35675===p?d=3:35676===p&&(d=4),n(l,".uniformMatrix",d,"fv(",v,",false,",h,");");else{switch(p){case 5126:s="1f";break;case 35664:s="2f";break;case 35665:s="3f";break;case 35666:s="4f";break;case 35670:case 5124:s="1i";break;case 35671:case 35667:s="2i";break;case 35672:case 35668:s="3i";break;case 35673:s="4i";break;case 35669:s="4i"}n(l,".uniform",s,"(",v,",",y(h)?Array.prototype.slice.call(h):h,");")}continue}f=d.append(e,n)}else{if(!a(_e))continue;f=n.def(u.uniforms,"[",t.id(h),"]")}switch(35678===p?n("if(",f,"&&",f,'._reglType==="framebuffer"){',f,"=",f,".color[0];","}"):35680===p&&n("if(",f,"&&",f,'._reglType==="framebufferCube"){',f,"=",f,".color[0];","}"),h=1,p){case 35678:case 35680:n(l,".uniform1i(",v,",",p=n.def(f,"._texture"),".bind());"),n.exit(p,".unbind();");continue;case 5124:case 35670:s="1i";break;case 35667:case 35671:s="2i",h=2;break;case 35668:case 35672:s="3i",h=3;break;case 35669:case 35673:s="4i",h=4;break;case 5126:s="1f";break;case 35664:s="2f",h=2;break;case 35665:s="3f",h=3;break;case 35666:s="4f",h=4;break;case 35674:s="Matrix2fv";break;case 35675:s="Matrix3fv";break;case 35676:s="Matrix4fv"}if(n(l,".uniform",s,"(",v,","),"M"===s.charAt(0)){v=Math.pow(p-35674+2,2);var m=e.global.def("new Float32Array(",v,")");n("false,(Array.isArray(",f,")||",f," instanceof Float32Array)?",f,":(",o(v,function(e){return m+"["+e+"]="+f+"["+e+"]"}),",",m,")")}else n(1<h?o(h,function(e){return f+"["+e+"]"}):f);n(");")}}function F(e,t,n,r){function i(i){var o=h[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(f,".",i)}function o(){function e(){n(u,".drawElementsInstancedANGLE(",[d,y,m,v+"<<(("+m+"-5121)>>1)",s],");")}function t(){n(u,".drawArraysInstancedANGLE(",[d,v,y,s],");")}p?b?e():(n("if(",p,"){"),e(),n("}else{"),t(),n("}")):t()}function a(){function e(){n(c+".drawElements("+[d,y,m,v+"<<(("+m+"-5121)>>1)"]+");")}function t(){n(c+".drawArrays("+[d,v,y]+");")}p?b?e():(n("if(",p,"){"),e(),n("}else{"),t(),n("}")):t()}var s,u,l=e.shared,c=l.gl,f=l.draw,h=r.draw,p=function(){var i=h.elements,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(f,".","elements"),i&&o("if("+i+")"+c+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),d=i("primitive"),v=i("offset"),y=function(){var i=h.count,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(f,".","count"),i}();if("number"==typeof y){if(0===y)return}else n("if(",y,"){"),n.exit("}");K&&(s=i("instances"),u=e.instancing);var m=p+".type",b=h.elements&&L(h.elements);K&&("number"!=typeof s||0<=s)?"string"==typeof s?(n("if(",s,">0){"),o(),n("}else if(",s,"<0){"),a(),n("}")):o():a()}function W(e,t,n,r,i){return i=(t=_()).proc("body",i),K&&(t.instancing=i.def(t.shared.extensions,".angle_instanced_arrays")),e(t,i,n,r),t.compile().body}function V(e,t,n,r){P(e,t),R(e,t,n,r.attributes,function(){return!0}),I(e,t,n,r.uniforms,function(){return!0}),F(e,t,t,n)}function q(e,t,n,r){function i(){return!0}e.batchId="a1",P(e,t),R(e,t,n,r.attributes,i),I(e,t,n,r.uniforms,i),F(e,t,t,n)}function U(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}P(e,t);var a=n.contextDep,s=t.def(),u=t.def();e.shared.props=u,e.batchId=s;var l=e.scope(),c=e.scope();t(l.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",u,"=","a0","[",s,"];",c,"}",l.exit),n.needsContext&&E(e,c,n.context),n.needsFramebuffer&&k(e,c,n.framebuffer),M(e,c,n.state,i),n.profile&&i(n.profile)&&N(e,c,n,!1,!0),r?(R(e,l,n,r.attributes,o),R(e,c,n,r.attributes,i),I(e,l,n,r.uniforms,o),I(e,c,n,r.uniforms,i),F(e,l,c,n)):(t=e.global.def("{}"),r=n.shader.progVar.append(e,c),u=c.def(r,".id"),l=c.def(t,"[",u,"]"),c(e.shared.gl,".useProgram(",r,".program);","if(!",l,"){",l,"=",t,"[",u,"]=",e.link(function(t){return W(q,e,n,t,2)}),"(",r,");}",l,".call(this,a0[",s,"],",s,");"))}function Y(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;E(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),C(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,i);y(r)?r.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,r)}),N(e,i,n,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new Q).forEach(function(e){i.set(o,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(n.state).length&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function G(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!y(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(z.isDynamic(e[t[n]]))return!0;return!1}}(r)){var i=e.global,o=Object.keys(r),a=!1,s=!1,u=!1,l=e.global.def("{}");o.forEach(function(t){var n=r[t];if(z.isDynamic(n))"function"==typeof n&&(n=r[t]=z.unbox(n)),t=B(n,null),a=a||t.thisDep,u=u||t.propDep,s=s||t.contextDep;else{switch(i(l,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}}),t.dynamic[n]=new z.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:u,ref:l,append:function(e,t){o.forEach(function(n){var i=r[n];z.isDynamic(i)&&(i=e.invoke(t,i),t(l,".",n,"=",i,";"))})}}),delete t.static[n]}}var Q=c.Record,X={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(X.min=32775,X.max=32776);var K=n.angle_instanced_arrays,Z=n.webgl_draw_buffers,J={dirty:!0,profile:v.profile},ee={},ne=[],re={},ie={};b("dither",3024),b("blend.enable",3042),g("blend.color","blendColor",[0,0,0,0]),g("blend.equation","blendEquationSeparate",[32774,32774]),g("blend.func","blendFuncSeparate",[1,0,1,0]),b("depth.enable",2929,!0),g("depth.func","depthFunc",513),g("depth.range","depthRange",[0,1]),g("depth.mask","depthMask",!0),g("colorMask","colorMask",[!0,!0,!0,!0]),b("cull.enable",2884),g("cull.face","cullFace",1029),g("frontFace","frontFace",2305),g("lineWidth","lineWidth",1),b("polygonOffset.enable",32823),g("polygonOffset.offset","polygonOffset",[0,0]),b("sample.alpha",32926),b("sample.enable",32928),g("sample.coverage","sampleCoverage",[1,!1]),b("stencil.enable",2960),g("stencil.mask","stencilMask",-1),g("stencil.func","stencilFunc",[519,0,-1]),g("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),g("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),b("scissor.enable",3089),g("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),g("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var oe={gl:e,context:p,strings:t,next:ee,current:J,draw:h,elements:a,buffer:i,shader:f,attributes:c.state,uniforms:l,framebuffer:u,extensions:n,timer:d,isBufferArgs:A},ae={primTypes:te,compareFuncs:me,blendFuncs:ye,blendEquations:X,stencilOps:be,glTypes:$,orientationType:ge};Z&&(ae.backBuffer=[1029],ae.drawBuffer=o(r.maxDrawbuffers,function(e){return 0===e?[0]:o(e,function(e){return 36064+e})}));var se=0;return{next:ee,current:J,procs:function(){var t=_(),n=t.proc("poll"),i=t.proc("refresh"),a=t.block();n(a),i(a);var s=t.shared,u=s.gl,l=s.next,c=s.current;a(c,".dirty=false;"),k(t,n),k(t,i,null,!0);var f,h=e.getExtension("angle_instanced_arrays");h&&(f=t.link(h));for(var p=0;p<r.maxAttributes;++p){var d=i.def(s.attributes,"[",p,"]"),v=t.cond(d,".buffer");v.then(u,".enableVertexAttribArray(",p,");",u,".bindBuffer(",34962,",",d,".buffer.buffer);",u,".vertexAttribPointer(",p,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(u,".disableVertexAttribArray(",p,");",u,".vertexAttrib4f(",p,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),i(v),h&&i(f,".vertexAttribDivisorANGLE(",p,",",d,".divisor);")}return Object.keys(re).forEach(function(e){var r=re[e],o=a.def(l,".",e),s=t.block();s("if(",o,"){",u,".enable(",r,")}else{",u,".disable(",r,")}",c,".",e,"=",o,";"),i(s),n("if(",o,"!==",c,".",e,"){",s,"}")}),Object.keys(ie).forEach(function(e){var r,s,f=ie[e],h=J[e],p=t.block();p(u,".",f,"("),y(h)?(f=h.length,r=t.global.def(l,".",e),s=t.global.def(c,".",e),p(o(f,function(e){return r+"["+e+"]"}),");",o(f,function(e){return s+"["+e+"]="+r+"["+e+"];"}).join("")),n("if(",o(f,function(e){return r+"["+e+"]!=="+s+"["+e+"]"}).join("||"),"){",p,"}")):(r=a.def(l,".",e),s=a.def(c,".",e),p(r,");",c,".",e,"=",r,";"),n("if(",r,"!==",s,"){",p,"}")),i(p)}),t.compile()}(),compile:function(e,t,n,r,i){var a=_();return a.stats=a.link(i),Object.keys(t.static).forEach(function(e){G(a,t,e)}),ve.forEach(function(t){G(a,e,t)}),n=function(e,t,n,r,i){var a=w(e),s=function(e,t,n){function r(e){if(e in i){var n=i[e];e=!0;var r,a,s=0|n.x,u=0|n.y;return"width"in n?r=0|n.width:e=!1,"height"in n?a=0|n.height:e=!1,new D(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var i=e.shared.context,o=r;"width"in n||(o=t.def(i,".","framebufferWidth","-",s));var l=a;return"height"in n||(l=t.def(i,".","framebufferHeight","-",u)),[s,u,o,l]})}if(e in o){var l=o[e];return e=B(l,function(e,t){var n=e.invoke(t,l),r=e.shared.context,i=t.def(n,".x|0"),o=t.def(n,".y|0");return[i,o,t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",o,")")]}),t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep),e}return t?new D(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".","framebufferWidth"),t.def(n,".","framebufferHeight")]}):null}var i=e.static,o=e.dynamic;if(e=r("viewport")){var a=e;e=new D(e.thisDep,e.contextDep,e.propDep,function(e,t){var n=a.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:e,scissor_box:r("scissor.box")}}(e,a),u=T(e),l=function(e,t){var n=e.static,r=e.dynamic,i={};return ne.forEach(function(e){function t(t,o){if(e in n){var s=t(n[e]);i[a]=H(function(){return s})}else if(e in r){var u=r[e];i[a]=B(u,function(e,t){return o(e,t,e.invoke(t,u))})}}var a=m(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,n){return n});case"depth.func":return t(function(e){return me[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return t(function(e){return e},function(e,t,n){return[t.def("+",n,"[0]"),t=t.def("+",n,"[1]")]});case"blend.func":return t(function(e){return[ye["srcRGB"in e?e.srcRGB:e.src],ye["dstRGB"in e?e.dstRGB:e.dst],ye["srcAlpha"in e?e.srcAlpha:e.src],ye["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,n){function r(e,r){return t.def('"',e,r,'" in ',n,"?",n,".",e,r,":",n,".",e)}e=e.constants.blendFuncs;var i=r("src","RGB"),o=r("dst","RGB"),a=(i=t.def(e,"[",i,"]"),t.def(e,"[",r("src","Alpha"),"]"));return[i,o=t.def(e,"[",o,"]"),a,e=t.def(e,"[",r("dst","Alpha"),"]")]});case"blend.equation":return t(function(e){return"string"==typeof e?[X[e],X[e]]:"object"==typeof e?[X[e.rgb],X[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,i=t.def(),o=t.def();return(e=e.cond("typeof ",n,'==="string"')).then(i,"=",o,"=",r,"[",n,"];"),e.else(i,"=",r,"[",n,".rgb];",o,"=",r,"[",n,".alpha];"),t(e),[i,o]});case"blend.color":return t(function(e){return o(4,function(t){return+e[t]})},function(e,t,n){return o(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return t(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return t(function(e){return[me[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){return[e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680),t.def(n,".ref|0"),t=t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,be[t.fail||"keep"],be[t.zfail||"keep"],be[t.zpass||"keep"]]},function(t,n,r){function i(e){return n.def('"',e,'" in ',r,"?",o,"[",r,".",e,"]:",7680)}var o=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,i("fail"),i("zfail"),i("zpass")]});case"polygonOffset.offset":return t(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return[t.def(n,".factor|0"),t=t.def(n,".units|0")]});case"cull.face":return t(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,n){return n});case"frontFace":return t(function(e){return ge[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,n){return o(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return[t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert")]})}}),i}(e),c=x(e),f=s.viewport;return f&&(l.viewport=f),(s=s[f=m("scissor.box")])&&(l[f]=s),(a={framebuffer:a,draw:u,shader:c,state:l,dirty:s=0<Object.keys(l).length}).profile=function(e){var t,n=e.static;if(e=e.dynamic,"profile"in n){var r=!!n.profile;(t=H(function(e,t){return r})).enable=r}else if("profile"in e){var i=e.profile;t=B(i,function(e,t){return e.invoke(t,i)})}return t}(e),a.uniforms=function(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var t,r=n[e];if("number"==typeof r||"boolean"==typeof r)t=H(function(){return r});else if("function"==typeof r){var a=r._reglType;"texture2d"===a||"textureCube"===a?t=H(function(e){return e.link(r)}):"framebuffer"!==a&&"framebufferCube"!==a||(t=H(function(e){return e.link(r.color[0])}))}else y(r)&&(t=H(function(e){return e.global.def("[",o(r.length,function(e){return r[e]}),"]")}));t.value=r,i[e]=t}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=B(t,function(e,n){return e.invoke(n,t)})}),i}(n),a.attributes=O(t),a.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=H(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=B(t,function(e,n){return e.invoke(n,t)})}),r}(r),a}(e,t,n,r),function(e,t){var n=e.proc("draw",1);P(e,n),E(e,n,t.context),k(e,n,t.framebuffer),S(e,n,t),M(e,n,t.state),N(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)V(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return W(V,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}(a,n),Y(a,n),function(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",P(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(E(e,r,t.context),o=!1);var a=!1;if((s=t.framebuffer)?(s.propDep?i=a=!0:s.contextDep&&i&&(a=!0),a||k(e,r,s)):k(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),S(e,r,t),M(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||N(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=a,(o=t.shader.progVar).contextDep&&i||o.propDep)U(e,r,t,null);else if(o=o.append(e,r),r(e.shared.gl,".useProgram(",o,".program);"),t.shader.program)U(e,r,t,t.shader.program);else{var s=e.global.def("{}"),u=(a=r.def(o,".id"),r.def(s,"[",a,"]"));r(e.cond(u).then(u,".call(this,a0,a1);").else(u,"=",s,"[",a,"]=",e.link(function(n){return W(U,e,t,n,2)}),"(",o,");",u,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}(a,n),a.compile()}}}function R(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var I=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},F=0,z={DynamicVariable:e,define:function(n,r){return new e(n,t(r+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t,n){return"function"==typeof t?new e(0,t):t},accessor:t},W={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},V="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},q=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},U=function(e){return Object.keys(e).map(function(t){return e[t]})},Y=o(8,function(){return[]}),G={alloc:s,free:u,allocType:function(e,t){var n=null;switch(e){case 5120:n=new Int8Array(s(t),0,t);break;case 5121:n=new Uint8Array(s(t),0,t);break;case 5122:n=new Int16Array(s(2*t),0,t);break;case 5123:n=new Uint16Array(s(2*t),0,t);break;case 5124:n=new Int32Array(s(4*t),0,t);break;case 5125:n=new Uint32Array(s(4*t),0,t);break;case 5126:n=new Float32Array(s(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n},freeType:function(e){u(e.buffer)}},Q={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;switch(n=r||G.allocType(n,i),t.length){case 0:break;case 1:for(r=t[0],t=0;t<r;++t)n[t]=e[t];break;case 2:for(r=t[0],t=t[1],o=i=0;o<r;++o)for(var a=e[o],s=0;s<t;++s)n[i++]=a[s];break;case 3:l(e,t[0],t[1],t[2],n,0);break;default:!function e(t,n,r,i,o){for(var a=1,s=r+1;s<n.length;++s)a*=n[s];var u=n[r];if(4==n.length-r){var c=n[r+1],f=n[r+2];for(n=n[r+3],s=0;s<u;++s)l(t[s],c,f,n,i,o),o+=a}else for(s=0;s<u;++s)e(t[s],n,r+1,i,o),o+=a}(e,t,0,n,0)}return n}},X={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},$={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},K={dynamic:35048,stream:35040,static:35044},Z=Q.flatten,J=Q.shape,ee=[];ee[5120]=1,ee[5122]=2,ee[5124]=4,ee[5121]=1,ee[5123]=2,ee[5125]=4,ee[5126]=4;var te={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ne=new Float32Array(1),re=new Uint32Array(ne.buffer),ie=[9984,9986,9985,9987],oe=[0,6409,6410,6407,6408],ae={};ae[6409]=ae[6406]=ae[6402]=1,ae[34041]=ae[6410]=2,ae[6407]=ae[35904]=3,ae[6408]=ae[35906]=4;var se=Object.keys(X).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),ue=[];ue[5121]=1,ue[5126]=4,ue[36193]=2,ue[5123]=2,ue[5125]=4;var le=[];le[32854]=2,le[32855]=2,le[36194]=2,le[34041]=4,le[33776]=.5,le[33777]=.5,le[33778]=1,le[33779]=1,le[35986]=.5,le[35987]=1,le[34798]=1,le[35840]=.5,le[35841]=.25,le[35842]=.5,le[35843]=.25,le[36196]=.5;var ce=[];ce[32854]=2,ce[32855]=2,ce[36194]=2,ce[33189]=2,ce[36168]=1,ce[34041]=4,ce[35907]=4,ce[34836]=16,ce[34842]=8,ce[34843]=6;var fe=function(e,t,n,r,i){function o(e){this.id=l++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,i.profile&&(this.stats={size:0})}function a(t){var n=t.renderbuffer;e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete c[t.id],r.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907),t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),t.webgl_color_buffer_float&&(s.rgba32f=34836);var u=[];Object.keys(s).forEach(function(e){u[s[e]]=e});var l=0,c={};return o.prototype.decRef=function(){0>=--this.refCount&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(c).forEach(function(t){e+=c[t].stats.size}),e}),{create:function(t,n){function a(t,n){var r=0,o=0,c=32854;if("object"==typeof t&&t?("shape"in t?(r=0|(o=t.shape)[0],o=0|o[1]):("radius"in t&&(r=o=0|t.radius),"width"in t&&(r=0|t.width),"height"in t&&(o=0|t.height)),"format"in t&&(c=s[t.format])):"number"==typeof t?(r=0|t,o="number"==typeof n?0|n:r):t||(r=o=1),r!==l.width||o!==l.height||c!==l.format)return a.width=l.width=r,a.height=l.height=o,l.format=c,e.bindRenderbuffer(36161,l.renderbuffer),e.renderbufferStorage(36161,c,r,o),i.profile&&(l.stats.size=ce[l.format]*l.width*l.height),a.format=u[l.format],a}var l=new o(e.createRenderbuffer());return c[l.id]=l,r.renderbufferCount++,a(t,n),a.resize=function(t,n){var r=0|t,o=0|n||r;return r===l.width&&o===l.height?a:(a.width=l.width=r,a.height=l.height=o,e.bindRenderbuffer(36161,l.renderbuffer),e.renderbufferStorage(36161,l.format,r,o),i.profile&&(l.stats.size=ce[l.format]*l.width*l.height),a)},a._reglType="renderbuffer",a._renderbuffer=l,i.profile&&(a.stats=l.stats),a.destroy=function(){l.decRef()},a},clear:function(){U(c).forEach(a)},restore:function(){U(c).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}},he=[];he[6408]=4;var pe=[];pe[5121]=1,pe[5126]=4,pe[36193]=2;var de=["x","y","z","w"],ve="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),ye={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},me={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},be={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ge={cw:2304,ccw:2305},_e=new D(!1,!1,!1,function(){});return function(e){function t(){if(0===X.length)M&&M.update(),J=null;else{J=W.next(t),h();for(var e=X.length-1;0<=e;--e){var n=X[e];n&&n(C,null,0)}m.flush(),M&&M.update()}}function i(){!J&&0<X.length&&(J=W.next(t))}function o(){J&&(W.cancel(t),J=null)}function a(e){e.preventDefault(),o(),$.forEach(function(e){e()})}function s(e){m.getError(),g.restore(),B.restore(),L.restore(),F.restore(),q.restore(),U.restore(),M&&M.restore(),Y.procs.refresh(),i(),K.forEach(function(e){e()})}function u(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];z.isDynamic(i)?n[r]=z.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}var n=t(e.context||{}),r=t(e.uniforms||{}),i=t(e.attributes||{}),o=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=I({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e));e={gpuTime:0,cpuTime:0,count:0};var a=(n=Y.compile(o,i,r,n,e)).draw,s=n.batch,u=n.scope,l=[];return I(function(e,t){var n;if("function"==typeof e)return u.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)u.call(this,null,t,n);else{if(!Array.isArray(e))return u.call(this,e,t,0);for(n=0;n<e.length;++n)u.call(this,e[n],t,n)}else if("number"==typeof e){if(0<e)return s.call(this,function(e){for(;l.length<e;)l.push(null);return l}(0|e),0|e)}else{if(!Array.isArray(e))return a.call(this,e);if(e.length)return s.call(this,e,e.length)}},{stats:e})}function l(e,t){var n=0;Y.procs.poll();var r=t.color;r&&(m.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(m.clearDepth(+t.depth),n|=256),"stencil"in t&&(m.clearStencil(0|t.stencil),n|=1024),m.clear(n)}function c(e){return X.push(e),i(),{cancel:function(){var t=R(X,e);X[t]=function e(){var t=R(X,e);X[t]=X[X.length-1],--X.length,0>=X.length&&o()}}}}function f(){var e=G.viewport,t=G.scissor_box;e[0]=e[1]=t[0]=t[1]=0,C.viewportWidth=C.framebufferWidth=C.drawingBufferWidth=e[2]=t[2]=m.drawingBufferWidth,C.viewportHeight=C.framebufferHeight=C.drawingBufferHeight=e[3]=t[3]=m.drawingBufferHeight}function h(){C.tick+=1,C.time=y(),f(),Y.procs.poll()}function v(){f(),Y.procs.refresh(),M&&M.update()}function y(){return(V()-P)/1e3}if(!(e=function(e){var t,i,o,a,s=e||{};e={};var u=[],l=[],c="undefined"==typeof window?1:window.devicePixelRatio,f=!1,h=function(e){},p=function(){};if("string"==typeof s?t=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?t=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?o=(a=s).canvas:("gl"in s?a=s.gl:"canvas"in s?o=r(s.canvas):"container"in s&&(i=r(s.container)),"attributes"in s&&(e=s.attributes),"extensions"in s&&(u=n(s.extensions)),"optionalExtensions"in s&&(l=n(s.optionalExtensions)),"onDone"in s&&(h=s.onDone),"profile"in s&&(f=!!s.profile),"pixelRatio"in s&&(c=+s.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?o=t:i=t),!a){if(!o){if(!(t=function(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;e!==document.body&&(t=(r=e.getBoundingClientRect()).right-r.left,r=r.bottom-r.top),i.width=n*t,i.height=n*r,I(i.style,{width:t+"px",height:r+"px"})}var i=document.createElement("canvas");return I(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",I(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(i)}}}(i||document.body,0,c)))return null;o=t.canvas,p=t.onDestroy}a=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(o,e)}return a?{gl:a,canvas:o,container:i,extensions:u,optionalExtensions:l,pixelRatio:c,profile:f,onDone:h,onDestroy:p}:(p(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(e)))return null;var m=e.gl,b=m.getContextAttributes();m.isContextLost();var g=function(e,t){function n(t){var n;t=t.toLowerCase();try{n=r[t]=e.getExtension(t)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw Error("(regl): error restoring extension "+e)})}}}(m,e);if(!g)return null;var _=function(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}(),w={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},x=g.extensions,M=function(e,t){function n(e,t,n){var r=a.pop()||new function(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null};r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,s.push(r)}var r=x.ext_disjoint_timer_query;if(!r)return null;var i=[],o=[],a=[],s=[],u=[],l=[];return{beginQuery:function(e){var t=i.pop()||r.createQueryEXT();r.beginQueryEXT(35007,t),o.push(t),n(o.length-1,o.length,e)},endQuery:function(){r.endQueryEXT(35007)},pushScopeStats:n,update:function(){var e,t;if(0!==(e=o.length)){l.length=Math.max(l.length,e+1),u.length=Math.max(u.length,e+1),u[0]=0;var n=l[0]=0;for(t=e=0;t<o.length;++t){var c=o[t];r.getQueryObjectEXT(c,34919)?(n+=r.getQueryObjectEXT(c,34918),i.push(c)):o[e++]=c,u[t+1]=n,l[t+1]=e}for(o.length=e,t=e=0;t<s.length;++t){var f=(n=s[t]).startQueryIndex;c=n.endQueryIndex,n.sum+=u[c]-u[f],f=l[f],(c=l[c])===f?(n.stats.gpuTime+=n.sum/1e6,a.push(n)):(n.startQueryIndex=f,n.endQueryIndex=c,s[e++]=n)}s.length=e}},getNumPendingQueries:function(){return o.length},clear:function(){i.push.apply(i,o);for(var e=0;e<i.length;e++)r.deleteQueryEXT(i[e]);o.length=0,i.length=0},restore:function(){o.length=0,i.length=0}}}(),P=V(),j=m.drawingBufferWidth,A=m.drawingBufferHeight,C={tick:0,time:0,viewportWidth:j,viewportHeight:A,framebufferWidth:j,framebufferHeight:A,drawingBufferWidth:j,drawingBufferHeight:A,pixelRatio:e.pixelRatio},D=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;return t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063)),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}}(m,x),L=p(m,w,e),H=d(m,x,L,w),B=(j=function(e,t,n,r,i){for(e=n.maxAttributes,t=Array(e),n=0;n<e;++n)t[n]=new E;return{Record:E,scope:{},state:t}}(m,x,D),k(m,_,w,e)),F=T(m,x,D,function(){Y.procs.poll()},C,w,e),q=fe(m,x,0,w,e),U=O(m,x,D,F,q,w),Y=N(m,_,x,D,L,H,0,U,{},j,B,{elements:null,primitive:4,count:-1,offset:0,instances:-1},C,M,e),G=(_=S(m,U,Y.procs.poll,C),Y.next),Q=m.canvas,X=[],$=[],K=[],Z=[e.onDestroy],J=null;Q&&(Q.addEventListener("webglcontextlost",a,!1),Q.addEventListener("webglcontextrestored",s,!1));var ee=U.setFBO=u({framebuffer:z.define.call(null,1,"framebuffer")});return v(),b=I(u,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ee(I({framebuffer:e.framebuffer.faces[t]},e),l);else ee(e,l);else l(0,e)},prop:z.define.bind(null,1),context:z.define.bind(null,2),this:z.define.bind(null,3),draw:u({}),buffer:function(e){return L.create(e,34962,!1,!1)},elements:function(e){return H.create(e,!1)},texture:F.create2D,cube:F.createCube,renderbuffer:q.create,framebuffer:U.create,framebufferCube:U.createCube,attributes:b,frame:c,on:function(e,t){var n;switch(e){case"frame":return c(t);case"lost":n=$;break;case"restore":n=K;break;case"destroy":n=Z}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:D,hasExtension:function(e){return 0<=D.extensions.indexOf(e.toLowerCase())},read:_,destroy:function(){X.length=0,o(),Q&&(Q.removeEventListener("webglcontextlost",a),Q.removeEventListener("webglcontextrestored",s)),B.clear(),U.clear(),q.clear(),F.clear(),H.clear(),L.clear(),M&&M.clear(),Z.forEach(function(e){e()})},_gl:m,_refresh:v,poll:function(){h(),M&&M.update()},now:y,stats:w}),e.onDone(null,b),b}},"object"==typeof be.exports?be.exports=me():this.createREGL=me(),be=be.exports;var ge={};Object.defineProperty(ge,"__esModule",{value:!0});var _e,we=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),xe=(_e=W)&&_e.__esModule?_e:{default:_e},Te=void 0;try{Te=be}catch(e){Te=null}var Oe=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,xe.default),we(t,[{key:"behaviorDidAttach",value:function(){var e=this;Te&&(this._sourceElement=this.el.querySelector("img, video"),this._canvas=this._createCanvas(),this._initRegl()?(this.connectTo("layout",this._resize.bind(this)),this.connectTo("interpolate",this._render.bind(this),function(){e._pollTimer=setInterval(e._pollSource.bind(e,!0),1e3/30)})):this._removeCanvas())}},{key:"update",value:function(){this._initRegl()}},{key:"behaviorWillDetach",value:function(){Te&&(clearInterval(this._pollTimer),this._regl.destroy())}},{key:"_createCanvas",value:function(){var e=document.createElement("canvas");return this.appendChild(e),e}},{key:"_removeCanvas",value:function(){this.removeChild(this._canvas)}},{key:"_resize",value:function(e){var t=e.layout;this._canvas.width=t.width,this._canvas.height=t.height,this._canvas.style.cssText=this._sourceElement.style.cssText,this._canvas.style.pointerEvents="none"}},{key:"_initRegl",value:function(){var e=this._regl;if(!e){try{e=Te(this._canvas)}catch(e){return Te=null,!1}this._regl=e}return this._draw=e({frag:this.props.shader.template,vert:"\n\t\t\t\tprecision mediump float;\n\n\t\t\t\tattribute vec2 position;\n\n\t\t\t\tvarying vec2 uv;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tuv = vec2(1.0 - position.x, position.y);\n\t\t\t\t\tgl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n\t\t\t\t}\n\t\t\t",attributes:{position:[-2,0,0,-2,2,2]},uniforms:{image:e.prop("image"),progress:e.prop("progress"),size:e.prop("size")},count:3}),!0}},{key:"_sourceIsReady",value:function(){return"IMG"===this._sourceElement.tagName?this._sourceElement.complete&&this._sourceElement.naturalWidth>0:"VIDEO"===this._sourceElement.tagName&&this._sourceElement.readyState>=2&&!this._sourceElement.seeking}},{key:"_getSourceIdentifier",value:function(){return"IMG"===this._sourceElement.tagName?this._sourceElement.src:"VIDEO"===this._sourceElement.tagName?[this._sourceElement.src,this._sourceElement.currentTime].join(";"):void 0}},{key:"_pollSource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._getSourceIdentifier();this._sourceIsReady()&&t!==this._sourceIdentifier&&(this._sourceIdentifier=t,this._updateTexture(e),e&&this._render(this.el.interpolate))}},{key:"_updateTexture",value:function(){this._texture&&(this._texture.destroy(),this._texture=null);try{this._texture=this._regl.texture(this._sourceElement)}catch(e){return}}},{key:"_render",value:function(e){this._pollSource(),this._texture&&(this._regl.poll(),this._draw({image:this._texture,progress:e.values.progress,size:[this._canvas.width,this._canvas.height]}),this.notify())}}],[{key:"behaviorSchema",get:function(){return{shader:{type:"template",default:"auto"}}}},{key:"behaviorName",get:function(){return"gl-effect"}},{key:"behaviorDependencies",get:function(){return["layout","interpolate","media"]}}]),t}();ge.default=Oe;var Ee={exports:{}};(function(e){!function(e,t){"object"==typeof Ee.exports?Ee.exports=t():e.ResizeObserver=t()}(this,function(){"use strict";var t=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some(function(e,r){return e[0]===t&&(n=r,!0)}),n}return function(){function t(){this.__entries__=[]}var n={size:{configurable:!0}};return n.size.get=function(){return this.__entries__.length},t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n+=1){var i=r[n];e.call(t,i[1],i[0])}},Object.defineProperties(t.prototype,n),t}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),i="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},o=2,a=["top","right","bottom","left","width","height","size","weight"],s="undefined"!=typeof MutationObserver,u=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,a=0;function s(){n&&(n=!1,e()),r&&l()}function u(){i(s)}function l(){var e=Date.now();if(n){if(e-a<o)return;r=!0}else n=!0,r=!1,setTimeout(u,t);a=e}return l}(this.refresh.bind(this),20)};u.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},u.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},u.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},u.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},u.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},u.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},u.prototype.onTransitionEnd_=function(e){var t=e.propertyName;void 0===t&&(t=""),a.some(function(e){return!!~t.indexOf(e)})&&this.refresh()},u.getInstance=function(){return this.instance_||(this.instance_=new u),this.instance_},u.instance_=null;var l=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n+=1){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},c=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||r},f=y(0,0,0,0);function h(e){return parseFloat(e)||0}function p(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return t.reduce(function(t,n){return t+h(e["border-"+n+"-width"])},0)}var d="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof c(e).SVGGraphicsElement}:function(e){return e instanceof c(e).SVGElement&&"function"==typeof e.getBBox};function v(e){return n?d(e)?function(e){var t=e.getBBox();return y(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return f;var r=c(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n+=1){var i=r[n],o=e["padding-"+i];t[i]=h(o)}return t}(r),o=i.left+i.right,a=i.top+i.bottom,s=h(r.width),u=h(r.height);if("border-box"===r.boxSizing&&(Math.round(s+o)!==t&&(s-=p(r,"left","right")+o),Math.round(u+a)!==n&&(u-=p(r,"top","bottom")+a)),!function(e){return e===c(e).document.documentElement}(e)){var l=Math.round(s+o)-t,d=Math.round(u+a)-n;1!==Math.abs(l)&&(s-=l),1!==Math.abs(d)&&(u-=d)}return y(i.left,i.top,s,u)}(e):f}function y(e,t,n,r){return{x:e,y:t,width:n,height:r}}var m=function(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=y(0,0,0,0),this.target=e};m.prototype.isActive=function(){var e=v(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},m.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e};var b=function(e,n,r){if(this.activeObservations_=[],this.observations_=new t,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=r};b.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new m(e)),this.controller_.addObserver(this),this.controller_.refresh())}},b.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},b.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},b.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},b.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new function(e,t){var n,r,i,o,a,s,u,c=(r=(n=t).x,i=n.y,o=n.width,a=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,u=Object.create(s.prototype),l(u,{x:r,y:i,width:o,height:a,top:i,right:r+o,bottom:a+i,left:r}),u);l(this,{target:e,contentRect:c})}(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},b.prototype.clearActive=function(){this.activeObservations_.splice(0)},b.prototype.hasActive=function(){return this.activeObservations_.length>0};var g="undefined"!=typeof WeakMap?new WeakMap:new t,_=function(e){if(!(this instanceof _))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=u.getInstance(),n=new b(e,t,this);g.set(this,n)};return["observe","unobserve","disconnect"].forEach(function(e){_.prototype[e]=function(){return(t=g.get(this))[e].apply(t,arguments);var t}}),void 0!==r.ResizeObserver?r.ResizeObserver:_})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),Ee=Ee.exports;var ke={};Object.defineProperty(ke,"__esModule",{value:!0});var Se=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Me=je(Ee),Pe=je(W);function je(e){return e&&e.__esModule?e:{default:e}}var Ae=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Pe.default),Se(t,[{key:"behaviorDidAttach",value:function(){this.intrinsicHeight=0,this.scrollUpdate={contentTopOffset:0},this.layout={},this.connectTo("^guides-layout",this._render.bind(this)),this.connectTo("^scroll",this._scroll.bind(this)),"auto"===this.props.height&&this._observeHeight()}},{key:"update",value:function(e){this.props.height!==e.height&&("auto"===this.props.height?this._observeHeight():"auto"===e.height&&this._unobserveHeight())}},{key:"behaviorWillDetach",value:function(){"auto"===this.props.height&&this._unobserveHeight()}},{key:"_observeHeight",value:function(){var e=this;this._resizeObserver=new Me.default(function(t){e.intrinsicHeight=t[0].contentRect.height,e.emit("heightchange")}),this._resizeObserver.observe(this.contentEl)}},{key:"_unobserveHeight",value:function(){this._resizeObserver.disconnect(),this._resizeObserver=null}},{key:"_render",value:function(){this._renderWrapper(),this._renderContent(),this._scroll(this.parentEl.scroll,!0),this.notify()}},{key:"_canSafelyBeUnloadedFromGPU",value:function(){return"auto"!==this.props.height}},{key:"_renderWrapper",value:function(){var e="visible",t=this.layout.width,n=this.layout.height;this.props.clip&&(e="hidden",n=this.layout.clipRect.height),this.props.hidden?(this.style.left="500vw",this.style.top="500vh",this.style.visibility="hidden",e="hidden"):(this.style.left="",this.style.top="",this.style.visibility=""),this.style.overflow=e,this.style.width=Math.round(t)+"px",this.style.height=Math.round(n)+"px"}},{key:"_renderContent",value:function(){this.contentStyle.position="relative",this.contentStyle.width=Math.round(this.layout.width)+"px","auto"===this.props.height?this.contentStyle.height="":this.contentStyle.height=Math.round(this.layout.height)+"px"}},{key:"_scroll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.scrollUpdate;if(this.parentEl.guidesLayout.engine.doScroll(this.layout,e.scrollState.position,n),this.props.hidden)this.style.willChange="",this.style.backfaceVisibility="",this.style.perspective="",this.style.transform="";else{if(n.wrapperTopChanged||t){var r=Math.round(this.layout.left),i=n.wrapperTop;this.style.willChange="transform",this.style.backfaceVisibility="hidden",this.style.perspective="1000",this.style.transform="translate("+r+"px, "+i+"px)"}n.contentTopOffsetChanged&&(this.contentStyle.willChange="transform",this.contentStyle.backfaceVisibility="hidden",this.contentStyle.perspective="1000",this.contentStyle.transform="translate(0, "+n.contentTopOffset+"px)")}n.inExtendedViewportChanged&&(n.inExtendedViewportChanged?this.emit("extendedviewport:enter"):this.emit("extendedviewport:leave")),n.inViewportChanged&&(n.inViewport?this.emit("viewport:enter"):this.emit("viewport:leave")),n.inCenterChanged&&(n.inCenter?this.emit("center:enter"):this.emit("center:leave"))}}],[{key:"behaviorSchema",get:function(){return{guides:{type:[{left:"string"},{right:"string"}],default:"viewport",expand:function(e){return 1===e.length&&"viewport"===e[0]&&(e.push("viewport"),!0)}},height:{type:"height",default:"auto"},spacing:{type:[{top:"csslength"},{bottom:"csslength"}],expand:function(e){return 1===e.length&&(e.push(e[0]),!0)},default:"0 0"},mode:{type:"string",enum:["flow","follow"],default:"flow"},followerMode:{type:"string",enum:["parallax","pin"],default:"parallax"},pinAnchor:{type:"string",enum:["top","center","bottom"],default:"center"},pinOffset:{type:"csslength",default:"0"},clip:{type:"boolean",default:"false"},dependencies:{type:"layoutdependencies",default:"inherit"},hidden:{type:"boolean",default:"false"}}}},{key:"behaviorName",get:function(){return"layout"}},{key:"behaviorDependencies",get:function(){return["^guides-layout","^scroll"]}}]),t}();ke.default=Ae;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});var De=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Le=Be(function(e,t){if(0===t)return[];if(1===t)return[e];if(t>=e.length){for(var n=[],r=0;r<t-e.length;++r)n.push([]);return e.map(function(e){return[e]}).concat(n)}for(var i=e.slice(0),o=[],a=function(e){for(var t=[0],n=1;n<=e.length;++n)t[n]=t[n-1]+e[n-1];return t}(i),s=function(e,t,n){for(var r=[],i=1;i<=e.length;++i)r[i]=[],r[i][1]=n[i];for(var o=1;o<=t;++o)r[1][o]=e[0];return r}(i,t,a),u=2;u<=i.length;++u)for(var l=2;l<=t;++l){s[u][l]=void 0;for(var c=1;c<u;++c){var f=Math.max(s[c][l-1],a[u]-a[c]);o[u]=o[u]||[],(void 0===s[u][l]||s[u][l]>f)&&(s[u][l]=f,o[u][l]=c)}}return function(e,t,n){for(var r=[];n>1;){if(t[e.length]){var i=t[e.length][n],o=e.splice(i);r.unshift(o)}n-=1}return r.unshift(e),r}(i,o,t)}),He=Be(W);function Be(e){return e&&e.__esModule?e:{default:e}}Be(ke);var Ne=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,He.default),De(t,[{key:"behaviorDidAttach",value:function(){this._items=Array.prototype.slice.call(this.el.querySelectorAll("img[width][height]")).map(function(e){return{image:e,ratio:e.getAttribute("width")/e.getAttribute("height")}}),this.connectTo("layout",this._render.bind(this))}},{key:"_render",value:function(e){var t=this.parentEl.guidesLayout.engine,n=t.viewport,r=t.lengthToPixel(this.props.spacing,0),i=t.lengthToPixel(this.props.height,n.height),o=t.lengthToPixel(this.props.minHeight,n.height),a=e.layout.width,s=Math.max(o,i),u=this._items.reduce(function(e,t){return e+t.ratio*s},0),l=Math.max(1,Math.round(u/a)),c=this._balancedLayout(this._items,a,l,r);this.contentStyle.height=c.requiredHeight+"px";for(var f=0;f<c.items.length;f++){var h=c.items[f],p=h.image.style;p.position="absolute",p.left=p.top="0px",p.width=h.width+"px",p.height=h.height+"px",p.transform=p.WebkitTransform=p.msTransform="translate("+h.left+"px, "+h.top+"px)"}}},{key:"_balancedLayout",value:function(e,t,n,r){var i=e.map(function(e){return e.ratio}),o=(0,Le.default)(i,Math.min(e.length,n)),a=[],s=0,u=r;return o.forEach(function(n){var i=e.slice(s,s+n.length),o=i.reduce(function(e,t){return e+t.ratio},0),l=(t-(n.length+1)*r)/o,c=r;i.forEach(function(e){var t=l*e.ratio;a.push({image:e.image,width:Math.round(t),height:Math.round(l),left:Math.round(c),top:Math.round(u)}),c=c+t+r}),u=u+l+r,s+=n.length}),{requiredHeight:Math.round(u),items:a}}}],[{key:"behaviorSchema",get:function(){return{spacing:{type:"csslength",default:"1vmin"},height:{type:"csslength",default:"33vh"},minHeight:{type:"csslength",default:"150px"}}}},{key:"behaviorName",get:function(){return"gallery"}},{key:"behaviorDependencies",get:function(){return["layout"]}}]),t}();Ce.default=Ne;var Re={};Object.defineProperty(Re,"__esModule",{value:!0});var Ie,Fe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ze=(Ie=W)&&Ie.__esModule?Ie:{default:Ie},We=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,ze.default),Fe(t,[{key:"behaviorDidAttach",value:function(){this.listen("click",this._handleClick.bind(this))}},{key:"_handleClick",value:function(e){if(1===e.which||0===e.button){var t=this._findParentLink(e.target);t&&this._handleLink(t)&&e.preventDefault()}}},{key:"_findParentLink",value:function(e){return e!==document&&e?"A"===e.tagName.toUpperCase()?e:this._findParentLink(e.parentElement):null}},{key:"_handleLink",value:function(e){if(e.hash.length<2)return!1;if(e.hostname!==window.location.hostname)return!1;if(e.pathname!==window.location.pathname)return!1;var t=document.getElementById(e.hash.substr(1));if(!t)return!1;if(!t.hasAttribute("layout")||!t.layout)return!1;var n=t.layout,r=n.layout,i=this.el.guidesLayout.engine,o=i.lengthToPixel(this.props.offset,r.height),a=i.calculateAnchorPosition(n,this.props.anchor,-o);return this.el.scroll.scrollTo(a,!0),!0}}],[{key:"behaviorSchema",get:function(){return{anchor:{type:"string",enum:["top","center","bottom"],default:"top"},offset:{type:"csslength",default:"0"}}}},{key:"behaviorName",get:function(){return"hash-navigation"}},{key:"behaviorDependencies",get:function(){return["guides-layout","scroll"]}}]),t}();Re.default=We;var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});var qe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ue=Ge(r),Ye=Ge(W);function Ge(e){return e&&e.__esModule?e:{default:e}}var Qe={type:[[{anchor:"string"},{offset:"csslength"},{value:"number"}]],expand:function(e){return 1===e.length?(e.push("0","1"),!0):2===e.length&&(e.splice(1,0,"0"),!0)},default:""},Xe=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ye.default),qe(t,[{key:"behaviorDidAttach",value:function(){this._interpolators={},this._defaultValues={opacity:1,scale:1},this.values={},this.connectTo("^guides-layout",this._createInterpolators.bind(this)),this.connectTo("^scroll",this._interpolate.bind(this))}},{key:"_createInterpolators",value:function(e){var t=this.constructor.behaviorSchema;for(var n in t)t.hasOwnProperty(n)&&(this.props[n].length>0?this._interpolators[n]=this._createInterpolator(e,this.props[n]):delete this._interpolators[n]);this._interpolate(this.parentEl.scroll)}},{key:"_createInterpolator",value:function(e,t){var n=this,r=e.engine,i=t.map(function(e){var t=r.lengthToPixel(e.offset,n.el.layout.layout.height);return{position:r.calculateAnchorPosition(n.el.layout,e.anchor,t),value:e.value}}),o=(i=i.sort(function(e,t){return e.position-t.position}))[0],a=i[i.length-1];return function(e){if(e<=o.position)return o.value;if(e>=a.position)return a.value;for(var t=1;t<i.length;t++){var n=i[t];if(e<n.position){var r=i[t-1];return(n.position-e)/(n.position-r.position)*(r.value-n.value)+n.value}}throw new Error("Could not interpolate")}}},{key:"_interpolate",value:function(e){var t=this.constructor.behaviorSchema,n=!1;for(var r in t)if(t.hasOwnProperty(r)){var i=this.values[r];this._interpolators.hasOwnProperty(r)?this.values[r]=this._interpolators[r](e.scrollState.position):this.values[r]=this._defaultValues.hasOwnProperty(r)?this._defaultValues[r]:0,i!==this.values[r]&&(n=!0)}n&&this.notify()}}],[{key:"behaviorSchema",get:function(){return{progress:(0,Ue.default)({},Qe,{default:"top -100vh 0, bottom 100vh 1"}),opacity:Qe,rotate:Qe,scale:Qe,x:Qe,y:Qe,alpha:Qe,beta:Qe,gamma:Qe,delta:Qe,epsilon:Qe}}},{key:"behaviorName",get:function(){return"interpolate"}},{key:"behaviorDependencies",get:function(){return["^guides-layout","^scroll","layout"]}}]),t}();Ve.default=Xe;var $e={};Object.defineProperty($e,"__esModule",{value:!0});var Ke,Ze=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Je=(Ke=W)&&Ke.__esModule?Ke:{default:Ke},et=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Je.default),Ze(t,[{key:"behaviorDidAttach",value:function(){var e=this,t=function(){r(),i()},n=function(){e.el.layout.scrollUpdate.inExtendedViewport&&(r(),i())},r=function(){for(var t=e.el.querySelectorAll("[data-src]"),n=0;n<t.length;n++){var r=t[n];r.src=r.getAttribute("data-src"),r.removeAttribute("data-src")}e.notify()},i=function(){e.unlisten("layout:viewport:enter",t),e.unlisten("^scroll:pause",n)};this.listen("layout:viewport:enter",t),this.listen("^scroll:pause",n)}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"lazy-load"}},{key:"behaviorDependencies",get:function(){return["^scroll","layout"]}}]),t}();$e.default=et;var tt={};Object.defineProperty(tt,"__esModule",{value:!0});var nt,rt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),it=(nt=W)&&nt.__esModule?nt:{default:nt},ot=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,it.default),rt(t,[{key:"behaviorDidAttach",value:function(){var e=this;this.videoEl=this.el.querySelector("video"),this._waitingForSeeked=!1,this.connectTo("interpolate",this._seek.bind(this)),this.listen("layout:extendedviewport:enter",function(){e.videoEl.load()})}},{key:"_getProgress",value:function(e){var t=e.values[this.props.parameter];return Math.abs(t)>1&&(t%=1),t<0&&(t=1+t),t}},{key:"_seek",value:function(e){var t=this,n=this.videoEl;isFinite(n.duration)&&(n.seeking?this._waitingForSeeked||(this._waitingForSeeked=!0,this.listenOnce(n,"seeked",function(){t._waitingForSeeked=!1,n.currentTime=n.duration*t._getProgress(e),n.pause(),t.notify()})):(n.currentTime=n.duration*this._getProgress(e),n.pause(),this.notify()))}}],[{key:"behaviorSchema",get:function(){return{parameter:{type:"string",default:"progress"}}}},{key:"behaviorName",get:function(){return"scrub"}},{key:"behaviorDependencies",get:function(){return["interpolate"]}}]),t}();tt.default=ot;var at={};Object.defineProperty(at,"__esModule",{value:!0});var st,ut=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),lt=(st=W)&&st.__esModule?st:{default:st},ct=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,lt.default),ut(t,[{key:"behaviorDidAttach",value:function(){for(var e=this,t=function(t){var n=e.props.signals[t];e.listen(n.eventName,function(){e.el[n.targetBehavior].onSignal(n.signalName,n.signalData)})},n=0;n<this.props.signals.length;n++)t(n)}},{key:"update",value:function(){}}],[{key:"behaviorSchema",get:function(){return{signals:{type:[[{eventName:"string"},{targetBehavior:"string"},{signalName:"string"},{signalData:"string"}]]}}}},{key:"behaviorName",get:function(){return"signals"}},{key:"behaviorDependencies",get:function(){return[]}}]),t}();at.default=ct;var ft={};Object.defineProperty(ft,"__esModule",{value:!0});var ht=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),pt=dt(W);function dt(e){return e&&e.__esModule?e:{default:e}}dt(Ve);var vt=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,pt.default),ht(t,[{key:"behaviorDidAttach",value:function(){this.connectTo("interpolate",this._render.bind(this))}},{key:"_render",value:function(e){var t=e.values;this.contentStyle.willChange="transform, opacity",this.contentStyle.opacity=t.opacity,this.contentStyle.backfaceVisibility="hidden",this.contentStyle.perspective="1000",this.contentStyle.transform="translate("+t.x+"%, "+t.y+"%) rotate("+t.rotate+"deg) scale("+t.scale+")",this.notify()}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"transform"}},{key:"behaviorDependencies",get:function(){return["interpolate"]}}]),t}();ft.default=vt;var yt={exports:{}};!function(e){var t={src:"https://www.youtube.com/iframe_api",loading:!1,loaded:!1,listeners:[],load:function(t){var n=this;if(this.listeners.push(t),this.loaded)setTimeout(function(){n.done()});else if(!this.loading){this.loading=!0,e.onYouTubeIframeAPIReady=function(){n.loaded=!0,n.done()};var r=document.createElement("script");r.type="text/javascript",r.src=this.src,document.body.appendChild(r)}},done:function(){for(delete e.onYouTubeIframeAPIReady;this.listeners.length;)this.listeners.pop()(e.YT)}};yt.exports?yt.exports=t:e.YouTubeIframeLoader=t}(window),yt=yt.exports;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});var bt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),gt=wt(yt),_t=wt(W);function wt(e){return e&&e.__esModule?e:{default:e}}var xt=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,_t.default),bt(t,[{key:"behaviorDidAttach",value:function(){var e=this;this._playASAP=!1;var t=this.el.querySelector("iframe");t||this.error(new Error("The youtube behavior expects a YouTube <iframe> as child of the element.")),-1===t.src.indexOf("enablejsapi=1")&&this.error(new Error('To use the youtube behavior the YouTube <iframe> src needs the "enablejsapi=1" parameter. The source is "'+t.src+'".')),gt.default.load(function(n){e._player=new n.Player(t),e._playASAP&&e._player.playVideo()})}},{key:"playVideo",value:function(){this._player?this._player.playVideo():this._playASAP=!0}},{key:"pauseVideo",value:function(){this._player?this._player.pauseVideo():this._playASAP=!1}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"youtube"}},{key:"behaviorDependencies",get:function(){return[]}}]),t}();mt.default=xt;var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});var Ot,Et=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),kt=(Ot=W)&&Ot.__esModule?Ot:{default:Ot},St=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,kt.default),Et(t,[{key:"behaviorDidAttach",value:function(){this._createElement(),this.connectTo("guides-layout",this._render.bind(this))}},{key:"_createElement",value:function(){this._guidesWrapper=document.createElement("div"),this._guidesWrapper.style.cssText="\n\t\t\tposition: fixed;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\tz-index: 1;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tpointer-events: none;\n\t\t",this.appendChild(this._guidesWrapper)}},{key:"_render",value:function(e){var t=this,n=e.engine.guides.map(function(e){var n=e.width,r=.2;return 0===e.width&&(n=1,r=1),'\n\t\t\t\t<div title="'+e.name+'" style="position: absolute; top: 0; bottom: 0; background:'+t.props.color+"; left: "+e.rightPosition+"px; opacity: "+r+"; px; width: "+n+'px;"></div>\n\t\t\t'});this._guidesWrapper.innerHTML=n.join(""),this.notify()}}],[{key:"behaviorSchema",get:function(){return{color:{type:"string",default:"#0cf"}}}},{key:"behaviorName",get:function(){return"debug-guides"}},{key:"behaviorDependencies",get:function(){return["guides-layout"]}}]),t}();Tt.default=St;var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});var Pt,jt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),At=(Pt=W)&&Pt.__esModule?Pt:{default:Pt},Ct=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,At.default),jt(t,[{key:"behaviorDidAttach",value:function(){var e=this;this.listenOnce("guides-layout:change",function(){e.style.opacity=1})}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"fadein"}},{key:"behaviorDependencies",get:function(){return["guides-layout"]}}]),t}();Mt.default=Ct;var Dt,Lt,Ht,Bt=Dt={};function Nt(){throw new Error("setTimeout has not been defined")}function Rt(){throw new Error("clearTimeout has not been defined")}function It(e){if(Lt===setTimeout)return setTimeout(e,0);if((Lt===Nt||!Lt)&&setTimeout)return Lt=setTimeout,setTimeout(e,0);try{return Lt(e,0)}catch(t){try{return Lt.call(null,e,0)}catch(t){return Lt.call(this,e,0)}}}!function(){try{Lt="function"==typeof setTimeout?setTimeout:Nt}catch(e){Lt=Nt}try{Ht="function"==typeof clearTimeout?clearTimeout:Rt}catch(e){Ht=Rt}}();var Ft,zt=[],Wt=!1,Vt=-1;function qt(){Wt&&Ft&&(Wt=!1,Ft.length?zt=Ft.concat(zt):Vt=-1,zt.length&&Ut())}function Ut(){if(!Wt){var e=It(qt);Wt=!0;for(var t=zt.length;t;){for(Ft=zt,zt=[];++Vt<t;)Ft&&Ft[Vt].run();Vt=-1,t=zt.length}Ft=null,Wt=!1,function(e){if(Ht===clearTimeout)return clearTimeout(e);if((Ht===Rt||!Ht)&&clearTimeout)return Ht=clearTimeout,clearTimeout(e);try{Ht(e)}catch(t){try{return Ht.call(null,e)}catch(t){return Ht.call(this,e)}}}(e)}}function Yt(e,t){this.fun=e,this.array=t}function Gt(){}Bt.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];zt.push(new Yt(e,t)),1!==zt.length||Wt||It(Ut)},Yt.prototype.run=function(){this.fun.apply(null,this.array)},Bt.title="browser",Bt.browser=!0,Bt.env={},Bt.argv=[],Bt.version="",Bt.versions={},Bt.on=Gt,Bt.addListener=Gt,Bt.once=Gt,Bt.off=Gt,Bt.removeListener=Gt,Bt.removeAllListeners=Gt,Bt.emit=Gt,Bt.prependListener=Gt,Bt.prependOnceListener=Gt,Bt.listeners=function(e){return[]},Bt.binding=function(e){throw new Error("process.binding is not supported")},Bt.cwd=function(){return"/"},Bt.chdir=function(e){throw new Error("process.chdir is not supported")},Bt.umask=function(){return 0};var Qt={};(function(e){(function(){var t,n,r,i,o,a;"undefined"!=typeof performance&&null!==performance&&performance.now?Qt=function(){return performance.now()}:void 0!==e&&null!==e&&e.hrtime?(Qt=function(){return(t()-o)/1e6},n=e.hrtime,i=(t=function(){var e;return 1e9*(e=n())[0]+e[1]})(),a=1e9*e.uptime(),o=i-a):Date.now?(Qt=function(){return Date.now()-r},r=Date.now()):(Qt=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(this,Dt);var Xt={};(function(e){for(var t="undefined"==typeof window?e:window,n=["moz","webkit"],r="AnimationFrame",i=t["request"+r],o=t["cancel"+r]||t["cancelRequest"+r],a=0;!i&&a<n.length;a++)i=t[n[a]+"Request"+r],o=t[n[a]+"Cancel"+r]||t[n[a]+"CancelRequest"+r];if(!i||!o){var s=0,u=0,l=[];i=function(e){if(0===l.length){var t=Qt(),n=Math.max(0,1e3/60-(t-s));s=n+t,setTimeout(function(){var e=l.slice(0);l.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(s)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return l.push({handle:++u,callback:e,cancelled:!1}),u},o=function(e){for(var t=0;t<l.length;t++)l[t].handle===e&&(l[t].cancelled=!0)}}(Xt=function(e){return i.call(t,e)}).cancel=function(){o.apply(t,arguments)},Xt.polyfill=function(e){e||(e=t),e.requestAnimationFrame=i,e.cancelAnimationFrame=o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var $t={exports:{}};!function(){var e=function(e){for(var t in this.options={animating:!0,animationDuration:250,bouncing:!0},e)this.options[t]=e[t]},t=function(e){return(e-=1)*e*e+1},n=function(e){return e<.5?4*e*e*e:4*(e-=1)*e*e+1},r=function(e){return 1===e?1:1-Math.pow(2,-10*e)},i=function(e){return(e-=1)*e*(4*e+3)+1},o={__isInteracting:!1,__isDragging:!1,__animation:null,__containerLength:0,__contentLength:0,__scrollOffset:0,__maxScrollOffset:0,__lastTouchOffset:null,__lastTouchMove:null,__positions:null,setLengths:function(e,t){e=Math.round(e),t=Math.round(t),e===this.__containerLength&&t===this.__contentLength||(this.__containerLength=e,this.__contentLength=t,this.__maxScrollOffset=Math.max(t-e,0),this.scrollTo(this.__scrollOffset,!0))},setContainerLength:function(e){this.setLengths(e,this.__contentLength)},setContentLength:function(e){this.setLengths(this.__containerLength,e)},getOffset:function(){var e,t,n=this.__animation;return n&&((e=(Date.now()-n.start)/n.duration)>=1?(this.__scrollOffset=n.from+n.distance,this.__animation=null):(e=n.easing(e),t=n.from+n.distance*e,this.options.bouncing||(t<0?(this.__animation=null,t=0):t>this.__maxScrollOffset&&(this.__animation=null,t=this.__maxScrollOffset)),this.__scrollOffset=t+.5|0)),this.__scrollOffset},getScrollMax:function(){return this.__maxScrollOffset},isResting:function(){return!this.__isInteracting&&!this.__animation},scrollTo:function(e,t){this.__animation&&(this.__animation=null),(e=Math.max(Math.min(this.__maxScrollOffset,e),0))===this.__scrollOffset&&(t=!1),this.__publish(e,t)},beginInteraction:function(e,t){this.__animation&&(this.__animation=null),this.__initialTouchOffset=e,this.__lastTouchOffset=e,this.__lastTouchMove=t,this.__isInteracting=!0,this.__isDragging=!1,this.__positions=[]},interact:function(e,t){if(this.__isInteracting){var n=this.__positions,r=this.__scrollOffset;if(this.__isDragging){var i=e-this.__lastTouchOffset,o=r-i;(o<0||o>this.__maxScrollOffset)&&(o=this.options.bouncing?r-i/3:o<0?0:this.__maxScrollOffset),n.length>60&&n.splice(0,30),o=o+.5|0,n.push(o,t),this.__publish(o)}else{var a=Math.abs(e-this.__initialTouchOffset);n.push(r,t),this.__isDragging=a>=5}this.__lastTouchOffset=e,this.__lastTouchMove=t}},endInteraction:function(e){if(this.__isInteracting&&this.__isDragging){this.__isInteracting=!1,this.__isDragging=!1;var t=this.__scrollOffset;if(t<0||t>this.__maxScrollOffset)return this.scrollTo(t,!0);if(this.options.animating){var n=this.__lastTouchMove;if(e-n<=100){for(var r=this.__positions,i=r.length-1,o=i,a=i;a>0&&!(r[a]<=n-100);a-=2)o=a;if(o!==i){var s=r[i]-r[o],u=(t-r[o-1])/s*(1e3/60);Math.abs(u)>1&&this.__startDeceleration(u)}}}this.__positions.length=0}},__publish:function(e,r){var i=!!this.__animation;if(i&&(this.__animation=null),r&&this.options.animating){var o=this.__scrollOffset,a=e-o;this.__animation={start:Date.now(),duration:this.options.animationDuration,easing:i?t:n,from:o,distance:a}}else this.__scrollOffset=e},__startDeceleration:function(e){var t=(Math.log(.1)-Math.log(Math.abs(e)))/Math.log(.95),n=t/60*1e3,o=e*((1-Math.pow(.95,t))/(1-.95)),a=this.__scrollOffset,s=a+o,u=this.__animation={start:Date.now(),duration:n,easing:r,from:this.__scrollOffset,distance:o+.5|0},l=s<0||s>this.__maxScrollOffset;this.options.bouncing&&l&&(u.distance=s<0?-a:this.__maxScrollOffset-a,u.easing=i,u.duration=u.duration/3)}};for(var a in o)e.prototype[a]=o[a];void 0!==$t.exports?$t.exports&&($t.exports=$t.exports=e):window.ScrollLogic=e}(),$t=$t.exports;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});var Zt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Jt=function(){function e(t,n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.onScroll=t,this.onPause=n,this.position=0,this.maxPosition=0,this.velocity=0,this.progress=0,this.direction="down",this.history=[]}return Zt(e,[{key:"tick",value:function(e,t){var n=void 0;this.history.push(this.position,e),this.history.length>60&&this.history.splice(0,30),this.velocity=this._calculateScrollVelocity(e),this.position!==t?(n=t>this.position?"down":"up",this.position=t,this.progress=t/this.maxPosition,this.direction!==n&&(this.direction=n,this.history.length=0),this._pauseTimer&&(clearTimeout(this._pauseTimer),delete this._pauseTimer),this.onScroll()):this._pauseTimer||(this._pauseTimer=setTimeout(this.onPause,300))}},{key:"destroy",value:function(){clearTimeout(this._pauseTimer)}},{key:"_calculateScrollVelocity",value:function(e){for(var t,n,r=this.history,i=r.length-1,o=i,a=i;a>0&&!(r[a]<=e-300);a-=2)o=a;return t=r[i]-r[o],n=r[i-1]-r[o-1],t>0&&Math.abs(n)>0?n/t:0}}]),e}();Kt.default=Jt;var en={};Object.defineProperty(en,"__esModule",{value:!0}),en.default={linear:function(e){return e},quad:function(e){return e*e},cubic:function(e){return e*e*e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5},sqrt:function(e){return Math.sqrt(e)},outCubic:function(e){return Math.pow(e-1,3)+1},natural:function(e){return 0===e?0:Math.exp(4*(e-1))},bounce:function(e){var t;if(e<=.5083)t=3;else if(e<=.8489)t=9;else if(e<=.96208)t=27;else{if(!(e<=.99981))return 1;t=91}return 1-Math.abs(3*Math.cos(e*t*1.028)/t)}};var tn={};Object.defineProperty(tn,"__esModule",{value:!0});var nn=void 0,rn=void 0,on=void 0;tn.default={start:function(e){var t=e.changedTouches[0];for(nn=t.clientX,rn=t.clientY,on=e.target;on.nodeType===Node.TEXT_NODE;)on=on.parentNode},end:function(e){var t=e.changedTouches[0],n=t.clientX,r=t.clientY,i=nn-n,o=rn-r,a=on;if(i*i+o*o<49){if("A"===a.tagName){var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,e.view,1,t.screenX,t.screenY,t.clientX,t.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),a.dispatchEvent(s)}a.focus()}}};var an={};Object.defineProperty(an,"__esModule",{value:!0}),an.default=function(e){return"TEXTAREA"===e.tagName||"INPUT"===e.tagName&&"text"===e.type};var sn={};Object.defineProperty(sn,"__esModule",{value:!0});var un=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ln=yn(Xt),cn=yn($t),fn=yn(Kt),hn=yn(tn),pn=yn(an),dn=yn(en),vn=yn(W);function yn(e){return e&&e.__esModule?e:{default:e}}var mn=/Android; (?:Mobile|Tablet); .+ Firefox/i.test(navigator.userAgent),bn=/Android /.test(navigator.userAgent)&&!/Chrome\/\d/.test(navigator.userAgent),gn=/iPhone|iPad|iPod/i.test(navigator.userAgent),_n=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,vn.default),un(t,[{key:"behaviorDidAttach",value:function(){this.scrollMode="touch",this._scrollAnimation=null,this._lastScrollTime=-1,this._setupScrolling(),this.connectTo("guides-layout",this._updateScrollHeight.bind(this)),(0,ln.default)(this._scrollLoop.bind(this))}},{key:"behaviorWillDetach",value:function(){this.scrollState.destroy()}},{key:"update",value:function(e){e.overscroll!==this.props.overscroll&&(this._scrollLogic.options.bouncing=this.props.overscroll)}},{key:"_setupScrolling",value:function(){this.scrollState=new fn.default(this.notify.bind(this),this.emit.bind(this,"pause",!1)),this._setupMobileScrolling(),this._handleScrollModes()}},{key:"_setupMobileScrolling",value:function(){var e=this;this._scrollLogic=new cn.default({bouncing:this.props.overscroll}),this.listen(document,"touchstart",function(t){(0,pn.default)(t.target)||bn||(t.preventDefault(),hn.default.start(t)),e._mousemoveCounter=0,e._scrollLogic.beginInteraction(t.changedTouches[0].pageY,t.timeStamp)}),this.listen(document,"touchmove",function(t){t.preventDefault(),e._mousemoveCounter=0,e._scrollLogic.interact(t.changedTouches[0].pageY,t.timeStamp)}),this.listen(document,"touchend touchcancel",function(t){(0,pn.default)(t.target)||bn||(t.preventDefault(),hn.default.end(t)),e._mousemoveCounter=0,e._scrollLogic.endInteraction(t.timeStamp)})}},{key:"_handleScrollModes",value:function(){var e=this,t=function(){var t=function t(){window.removeEventListener("mousemove",r,!1),window.removeEventListener("scroll",t,!1);var i=e._scrollLogic.getOffset(),o=e._getNativeScrollPosition()-e._lastNativeScrollPosition;window.scrollTo(0,i+o),e.scrollMode="native",n()},r=function(){e._mousemoveCounter++,3===e._mousemoveCounter&&(e._mousemoveCounter=0,t())};window.addEventListener("mousemove",r,!1),window.addEventListener("scroll",t,!1)},n=function(){document.addEventListener("touchstart",function n(){document.removeEventListener("touchstart",n,!1);var r=Math.round(e._getNativeScrollPosition());e._scrollLogic.scrollTo(r),e._mousemoveCounter=0,e.scrollMode="touch",t()},!1)};this._mousemoveCounter=0,t()}},{key:"_getNativeScrollPosition",value:function(){if(!document.documentElement||!document.body)throw new Error("There is no documentElement or body to get the scroll position from.");return document.documentElement.scrollTop||document.body.scrollTop}},{key:"_updateScrollAnimation",value:function(e){var t=this._scrollAnimation;t.hasOwnProperty("startTime")||(t.startTime=e,t.endTime=e+Math.abs(t.targetPosition-t.startPosition)/3);var n=void 0;if(e>t.endTime)n=t.targetPosition,this._scrollAnimation=null;else{var r=void 0;r=1-(t.endTime-e)/(t.endTime-t.startTime),r=dn.default.outCubic(r),n=t.startPosition+(t.targetPosition-t.startPosition)*r}this.scrollTo(n)}},{key:"scrollTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=Math.round(e),t){var n=this.getPosition();this._scrollAnimation={startPosition:n,targetPosition:e}}else"native"===this.scrollMode?window.scrollTo(0,e):this._scrollLogic.scrollTo(e)}},{key:"_scrollLoop",value:function(e){-1===this._lastScrollTime&&(this._lastScrollTime=e),this._pollScrollPosition(e),this._lastScrollTime=e,(0,ln.default)(this._scrollLoop.bind(this))}},{key:"getPosition",value:function(){return"touch"===this.scrollMode?this._scrollLogic.getOffset():this._lastNativeScrollPosition=Math.round(this._getNativeScrollPosition())}},{key:"_pollScrollPosition",value:function(e){this._scrollAnimation&&this._updateScrollAnimation(e),this.scrollState.tick(e,this.getPosition())}},{key:"_updateScrollHeight",value:function(e){var t=e.engine,n=t.requiredHeight;if(mn||bn||gn){if(!document.documentElement)throw new Error("There is no documentElement to style.");document.documentElement.style.overflow="visible",this.style.height=0}else this.style.height=Math.round(n)+"px";this._scrollLogic.setContainerLength(t.viewport.height),this._scrollLogic.setContentLength(n),this.scrollState.maxPosition=n-t.viewport.height,this.scrollTo(this.scrollState.maxPosition*this.scrollState.progress)}}],[{key:"behaviorSchema",get:function(){return{overscroll:{type:"boolean",default:gn?"true":"false"}}}},{key:"behaviorName",get:function(){return"scroll"}},{key:"behaviorDependencies",get:function(){return["guides-layout"]}}]),t}();sn.default=_n;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});var xn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Tn=function(){function e(){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.guides=[],this.requiredHeight=0,this.viewport={width:0,height:0,outerWidth:0,outerHeight:0},this.fullscreenLayout={left:0,top:0,width:0,height:0}}return xn(e,[{key:"updateViewport",value:function(e){return(e.height!==this.viewport.height||e.width!==this.viewport.width||e.outerWidth!==this.viewport.outerWidth||e.outerHeight!==this.viewport.outerHeight)&&(this.viewport=e,this.fullscreenLayout={left:0,top:0,width:e.outerWidth,height:e.outerHeight},!0)}},{key:"lengthToPixel",value:function(e,t){switch(e.unit){case"px":return e.length;case"vw":return e.length/100*this.viewport.width;case"vh":return e.length/100*this.viewport.height;case"vmin":return e.length/100*Math.min(this.viewport.width,this.viewport.height);case"vmax":return e.length/100*Math.max(this.viewport.width,this.viewport.height);case"%":if(null==t)throw new Error("To convert percentages to pixels a reference value needs to be specified.");return t*(e.length/100);default:throw new Error('Unknown unit "'+e.unit+'" of length "'+e.length+'"')}}},{key:"calculateAnchorPosition",value:function(e,t,n){var r=e.layout,i=void 0,o=void 0;return"follow"===e.props.mode?(i=r.leaderTop,o=r.leaderHeight):(i=r.top,o=r.height),"bottom"===t?i=i-this.viewport.height+o:"center"===t&&(i=i-this.viewport.height/2+o/2),Math.round(i+n)}},{key:"doLayout",value:function(e,t,n){this._computeGuides(t,n);for(var r=0;r<e.length;r++)e[r].layout.dirty=!0;this.requiredHeight=0;var i=void 0;do{i=!1;var o=!1;e:for(var a=0;a<e.length;a++){var s=e[a];if(s.layout.dirty){for(var u=s.props.dependencies.nodes,l=0;l<u.length;l++)if(u[l].layout.dirty){i=!0;continue e}this._doNodeLayout(s,u),s.layout.dirty=!1,o=!0,s.layout.requiredHeight>this.requiredHeight&&(this.requiredHeight=s.layout.requiredHeight)}}if(e.length>0&&!o)throw new Error("The layout engine did a whole loop of just skipping. It seems like some dependencies cannot be resolved.")}while(i)}},{key:"doScroll",value:function(e,t,n){var r=this.viewport.height/2,i=e.height,o=n.wrapperTop,a=n.contentTopOffset,s=n.inCenter,u=n.inViewport,l=n.inExtendedViewport;e.transformTopPosition?n.contentTop=e.transformTopPosition(t):n.contentTop=e.top-t,e.clipRect?(n.wrapperTop=e.clipRect.top-t,n.wrapperHeight=e.clipRect.height):(n.wrapperTop=n.contentTop,n.wrapperHeight=i),n.wrapperBottom=Math.round(n.wrapperTop+n.wrapperHeight),n.contentBottom=Math.round(n.contentTop+i),n.wrapperTop=Math.round(n.wrapperTop),n.contentTop=Math.round(n.contentTop),n.contentTopOffset=n.contentTop-n.wrapperTop,n.inCenter=n.wrapperTop<r&&n.wrapperBottom>r,n.inExtendedViewport=n.wrapperTop<2*this.viewport.height&&n.wrapperBottom>-this.viewport.height,n.absoluteWrapperTop=n.wrapperTop,n.absoluteContentTop=n.contentTop,n.wrapperTop>=this.viewport.height?(n.wrapperTop=this.viewport.height,n.contentTop=n.wrapperTop+n.contentTopOffset,n.inViewport=!1):n.wrapperBottom<=0?(n.wrapperTop=-Math.round(n.wrapperHeight),n.contentTop=n.wrapperTop+n.contentTopOffset,n.inViewport=!1):n.inViewport=!0,n.wrapperTopChanged=n.wrapperTop!==o,n.contentTopOffsetChanged=n.contentTopOffset!==a,n.inCenterChanged=n.inCenter!==s,n.inViewportChanged=n.inViewport!==u,n.inExtendedViewportChanged=n.inExtendedViewport!==l}},{key:"_doNodeLayout",value:function(e,t){var n=e.layout,r=e.props,i=e.intrinsicHeight,o=r.mode;if("follow"===o){for(var a=t[0],s=a,u=0;u<t.length;u++){var l=t[u];l.layout.top<a.layout.top&&(a=l),l.layout.bottom>s.layout.bottom&&(s=l)}t=[a,s],n.leaderTop=a.layout.top,n.leaderHeight=s.layout.bottom-a.layout.top}if("viewport"===r.guides.left?n.left=0:n.left=this._getGuideByName(r.guides.left).leftPosition,"viewport"===r.guides.right?n.right=this.viewport.width:n.right=this._getGuideByName(r.guides.right).rightPosition,n.width=n.right-n.left,"auto"===r.height?n.height=i:n.height=this.lengthToPixel(r.height,n.width),n.spacingTop=this.lengthToPixel(r.spacing.top,n.height),n.spacingBottom=this.lengthToPixel(r.spacing.bottom,n.height),n.outerHeight=n.height+n.spacingTop+n.spacingBottom,"flow"===o){for(var c=0,f=0;f<t.length;f++){var h=t[f];h.layout.outerBottom>c&&(c=h.layout.outerBottom)}n.top=c+n.spacingTop}else"follow"===o&&("pin"===r.followerMode&&n.outerHeight>n.leaderHeight?n.top=t[1].layout.bottom-n.height-n.spacingBottom:n.top=t[0].layout.top+n.spacingTop);n.outerTop=n.top+n.spacingTop,n.bottom=n.height+n.top,n.outerBottom=n.bottom+n.spacingBottom,n.requiredHeight="flow"===o?n.outerBottom:0,"follow"===o&&(n.transformTopPosition=this._createFollowerTopPositionTransformer(n,r)),r.clip&&"follow"===o?(n.clipRect||(n.clipRect={top:0,bottom:0,height:0}),n.clipRect.top=t[0].layout.top,n.clipRect.bottom=t[1].layout.bottom,n.clipRect.height=n.leaderHeight):delete n.clipRect}},{key:"_createFollowerTopPositionTransformer",value:function(e,t){var n=this;if("pin"===t.followerMode){var r=void 0;switch(t.pinAnchor){case"top":r=0;break;case"center":r=(this.viewport.height-e.height)/2;break;case"bottom":r=this.viewport.height-e.height;break;default:throw new Error('Unknown pinAnchor "'+t.pinAnchor+'".')}var i=e.top-r,o=Math.abs(e.leaderHeight-e.outerHeight),a=i+o;return function(t){var n;return n=t<i?e.top-t:t<a?r:e.top-t+o,Math.round(n)}}if("parallax"===t.followerMode){var s=this.viewport.height+e.leaderHeight,u=(this.viewport.height+e.outerHeight)/s,l=e.outerTop-this.viewport.height;return function(t){var r=t-l;return n.viewport.height+e.spacingTop-r*u}}}},{key:"_computeGuides",value:function(e,t){var n=this.lengthToPixel(t,this.viewport.width);n>this.viewport.width&&(n=this.viewport.width);var r=(this.viewport.width-n)/2;this.guides.length=e.length;for(var i=0;i<e.length;i++){var o=e[i],a=this.guides[i];a||(a=this.guides[i]={}),a.name=o.name,a.width=this.lengthToPixel(o.width,n);var s=this.lengthToPixel(o.position,n);a.position=s>=0?r+s:r+n+s,a.leftPosition=a.position+a.width/2,a.rightPosition=a.position-a.width/2,a.rightPosition<0?(a.rightPosition=0,a.leftPosition=a.width,a.position=a.width/2):a.leftPosition>this.viewport.width&&(a.leftPosition=this.viewport.width,a.rightPosition=a.leftPosition-a.width,a.position=a.leftPosition-a.width/2)}}},{key:"_getGuideByName",value:function(e){for(var t=0;t<this.guides.length;t++){var n=this.guides[t];if(n.name===e)return n}throw new Error("Looks like you've used a guide called \""+e+'" without defining it.')}}]),e}();wn.default=Tn;var On={};Object.defineProperty(On,"__esModule",{value:!0});var En=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),kn=Pn(Xt),Sn=Pn(wn),Mn=Pn(W);function Pn(e){return e&&e.__esModule?e:{default:e}}var jn=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Mn.default),En(t,[{key:"behaviorDidAttach",value:function(){this._layoutScheduled=!1,this._initLayoutEngine()}},{key:"update",value:function(){this._scheduleLayout()}},{key:"_initLayoutEngine",value:function(){var e=this;this.engine=new Sn.default,this.listenAndInvoke(window,"resize",function(){var t=e._getViewport();e.engine.updateViewport(t)&&e._scheduleLayout()}),this.listen("layout:attach layout:update layout:heightchange",this._scheduleLayout.bind(this))}},{key:"_getScrollbarWidth",value:function(){if(this._getScrollbarWidth.hasOwnProperty("_cache"))return this._getScrollbarWidth._cache;var e=document.documentElement;if(!e)throw new Error("There is no documentElement to get the scrollbar width of.");var t=e.style.overflowY;e.style.overflowY="scroll";var n=e.clientWidth;e.style.overflowY="hidden";var r=e.clientWidth;return e.style.overflowY=t,this._getScrollbarWidth._cache=r-n}},{key:"_getViewport",value:function(){this._viewportSizeElement||(this._viewportSizeElement=document.createElement("div"),this._viewportSizeElement.style.cssText="\n\t\t\t\twidth: 100vw;\n\t\t\t\theight: 100vh;\n\t\t\t\tposition: fixed;\n\t\t\t\tleft: -100vw;\n\t\t\t\ttop: -100vh;\n\t\t\t\tpointer-events: none;\n\t\t\t\tvisibility: hidden;\n\t\t\t\topacity: 0;\n\t\t\t\tz-index: -1;",this.appendChild(this._viewportSizeElement));var e=this._viewportSizeElement.getBoundingClientRect(),t=e.width,n=t-this._getScrollbarWidth(),r=e.height;return{width:n,height:r,outerWidth:t,outerHeight:r}}},{key:"_scheduleLayout",value:function(){this._layoutScheduled||((0,kn.default)(this._doLayout.bind(this)),this._layoutScheduled=!0)}},{key:"_doLayout",value:function(){this._layoutScheduled=!1;var e=Array.prototype.slice.call(this.el.querySelectorAll("[layout]")).map(function(e){return e.layout});this.engine.doLayout(e,this.props.guides,this.props.width),this.notify()}}],[{key:"behaviorSchema",get:function(){return{guides:{type:[[{name:"string"},{position:"csslength"},{width:"csslength"}]],expand:function(e){return 2===e.length&&(e.push("0"),!0)},default:""},width:{type:"csslength",default:"1280px"}}}},{key:"behaviorName",get:function(){return"guides-layout"}},{key:"behaviorDependencies",get:function(){return[]}}]),t}();On.default=jn;var An={};Object.defineProperty(An,"__esModule",{value:!0});var Cn,Dn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ln=(Cn=W)&&Cn.__esModule?Cn:{default:Cn},Hn=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ln.default),Dn(t,[{key:"behaviorDidAttach",value:function(){this.connectTo("layout",this._render.bind(this))}},{key:"behaviorWillDetach",value:function(){var e=this.el.querySelector("img, video").style;e.display="",e.position="",e.left=e.top="",e.maxWidth=e.maxHeight="",e.width="",e.height="",e.transform=""}},{key:"_render",value:function(e){var t=this.calculateMediaLayout(e),n=this.el.querySelector("img, video").style;n.display="block",n.position="absolute",n.left=n.top=0,n.maxWidth=n.maxHeight="none",n.width=Math.round(t.width)+"px",n.height=Math.round(t.height)+"px",n.transform="translate("+Math.round(t.left)+"px, "+Math.round(t.top)+"px)",this.notify()}},{key:"_calculateMediaSize",value:function(e){var t=this.props.ratio.num,n=this.props.fit,r=e.layout,i=r.width,o=r.height,a=i/o;return"fill"!==n&&("contain"===n&&a>t||"cover"===n&&a<t?i=o*t:o=i/t),{width:i,height:o}}},{key:"calculateMediaLayout",value:function(e){var t=this.parentEl.guidesLayout.engine,n=this._calculateMediaSize(e),r=this.props.fit,i=e.layout,o=i.width,a=i.height,s=this.props.position,u=s.x,l=s.y,c=t.lengthToPixel(u,n.width),f=t.lengthToPixel(l,n.height),h=void 0,p=void 0;return"cover"===r?(h=o/2-c,p=a/2-f,h=Math.min(0,Math.max(o-n.width,h)),p=Math.min(0,Math.max(a-n.height,p))):(h=o/2-n.width/2,p=a/2-n.height/2),{width:n.width,height:n.height,left:h,top:p}}}],[{key:"behaviorSchema",get:function(){return{ratio:{type:"ratio"},fit:{type:"string",enum:["fill","cover","contain"],default:"cover"},position:{type:[{x:"csslength"},{y:"csslength"}],expand:function(e){return 1===e.length&&(e.push(e[0]),!0)},default:"50% 50%"}}}},{key:"behaviorName",get:function(){return"media"}},{key:"behaviorDependencies",get:function(){return["^guides-layout","layout"]}}]),t}();An.default=Hn;var Bn={};Object.defineProperty(Bn,"__esModule",{value:!0});var Nn,Rn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),In=(Nn=W)&&Nn.__esModule?Nn:{default:Nn},Fn=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,In.default),Rn(t,[{key:"behaviorDidAttach",value:function(){this._render()}},{key:"update",value:function(){this._render()}},{key:"_render",value:function(){this.style.pointerEvents="none"}}],[{key:"behaviorSchema",get:function(){return{native:{type:"string",enum:["always","fullscreen","never"],default:"fullscreen"},touch:{type:"string",enum:["always","fullscreen","never"],default:"fullscreen"}}}},{key:"behaviorName",get:function(){return"mousetrap"}},{key:"behaviorDependencies",get:function(){return["^guides-layout"]}}]),t}();Bn.default=Fn;var zn={};Object.defineProperty(zn,"__esModule",{value:!0});var Wn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Vn=Gn(Xt),qn=Gn(Kt),Un=Gn(en),Yn=Gn(W);function Gn(e){return e&&e.__esModule?e:{default:e}}var Qn=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Yn.default),Wn(t,[{key:"behaviorDidAttach",value:function(){this._scrollAnimation=null,this._lastScrollTime=-1,this.scrollState=new qn.default(this.notify.bind(this),this.emit.bind(this,"pause",!1)),this.connectTo("guides-layout",this._updateScrollHeight.bind(this)),(0,Vn.default)(this._scrollLoop.bind(this))}},{key:"behaviorWillDetach",value:function(){this.scrollState.destroy()}},{key:"_updateScrollAnimation",value:function(e){var t=this._scrollAnimation;t.hasOwnProperty("startTime")||(t.startTime=e,t.endTime=e+Math.abs(t.targetPosition-t.startPosition)/3);var n=void 0;if(e>t.endTime)n=t.targetPosition,this._scrollAnimation=null;else{var r=void 0;r=1-(t.endTime-e)/(t.endTime-t.startTime),r=Un.default.outCubic(r),n=t.startPosition+(t.targetPosition-t.startPosition)*r}this.scrollTo(n)}},{key:"scrollTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=Math.round(e),t){var n=this.getPosition();this._scrollAnimation={startPosition:n,targetPosition:e}}else window.scrollTo(0,e)}},{key:"_scrollLoop",value:function(e){-1===this._lastScrollTime&&(this._lastScrollTime=e),this._pollScrollPosition(e),this._lastScrollTime=e,(0,Vn.default)(this._scrollLoop.bind(this))}},{key:"getPosition",value:function(){if(!document.documentElement||!document.body)throw new Error("There is no documentElement or body to get the scroll position from.");return document.documentElement.scrollTop||document.body.scrollTop}},{key:"_pollScrollPosition",value:function(e){this._scrollAnimation&&this._updateScrollAnimation(e),this.scrollState.tick(e,this.getPosition())}},{key:"_updateScrollHeight",value:function(e){var t=e.engine,n=t.requiredHeight;this.style.height=Math.round(n)+"px",this.scrollState.maxPosition=n-t.viewport.height,this.scrollTo(this.scrollState.maxPosition*this.scrollState.progress)}}],[{key:"behaviorSchema",get:function(){return{}}},{key:"behaviorName",get:function(){return"real-scroll"}},{key:"behaviorDependencies",get:function(){return["guides-layout"]}}]),t}();zn.default=Qn;var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0});var $n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Kn=/^[a-z-]+$/,Zn=function(){function e(){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._closed=!1,this._behaviors={},this._order=[]}return $n(e,[{key:"add",value:function(e){var t=e.behaviorName;if(this._behaviors.hasOwnProperty(t))throw new Error('You are trying to redefine the "'+t+'" behavior.');if(!Kn.test(t))throw new Error('The behavior "'+t+'" you are trying to define uses invalid characters. Behaviors can only use lower case characters and dashes.');if(this._closed)throw new Error('You are trying to define the "'+t+'" behavior too late. You need to define behaviors before DOMContentLoaded."');for(var n=e.behaviorDependencies,r=0;r<n.length;r++){var i=n[r];if("^"===i.charAt(0)&&(i=i.slice(1)),!this._behaviors.hasOwnProperty(i))throw new Error('You are trying to define a "'+t+'" behavior that depends on "'+i+'", which is not defined. Make sure to define behaviors in the correct order.')}this._behaviors[t]=e,this._order.push(t)}},{key:"has",value:function(e){return this._behaviors.hasOwnProperty(e)}},{key:"get",value:function(e){return this._behaviors[e]}},{key:"getNames",value:function(){return Object.keys(this._behaviors)}},{key:"getOrder",value:function(){return this._order.slice()}},{key:"close",value:function(){this._closed=!0}}]),e}();Xn.default=Zn;var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});var er=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),tr=/^[a-z-]+$/,nr=function(){function e(){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._conditions={}}return er(e,[{key:"add",value:function(e,t){if(this._conditions.hasOwnProperty(e))throw new Error('You are trying to redefine the "'+e+'" condition.');if(!tr.test(e))throw new Error('The condition "'+e+'" you are trying to define uses invalid characters. Conditions can only use lower case characters and dashes.');this._conditions[e]=t}},{key:"has",value:function(e){return this._conditions.hasOwnProperty(e)}},{key:"get",value:function(e){return this._conditions[e]}},{key:"getNames",value:function(){return Object.keys(this._conditions)}}]),e}();Jn.default=nr;var rr={};Object.defineProperty(rr,"__esModule",{value:!0});var ir=sr(F),or=sr(Xn),ar=sr(Jn);function sr(e){return e&&e.__esModule?e:{default:e}}var ur={Behavior:sr(W).default,behaviorsRegistry:new or.default,conditionsRegistry:new ar.default,version:"0.0.1",getDefinedBehaviorNames:function(){return this.behaviorsRegistry.getNames()},getBehaviorOrder:function(){return this.behaviorsRegistry.getOrder()},registerBehavior:function(e){this.behaviorsRegistry.add(e)},attachBehaviors:function(e,t){for(var n=this.getBehaviorOrder(),r=0;r<n.length;r++){var i=n[r];if(t.hasOwnProperty(i)){var o=this._checkBehaviorDependencies(e,i);if(o.length>0)throw new Error('The "'+i+'" behavior requires the "'+o.join('", "')+'" behavior(s). Make sure you add the attribute to the element.');this.attachBehavior(e,i,t[i])}}},attachBehavior:function(e,t,n){if(!this.behaviorsRegistry.has(t))throw new Error('Tried to attach an unknown behavior "'+t+'". This should never happen since we only track attributes that correspond to defined behaviors.');e.hasOwnProperty(t)?e[t].updateProperties(n):new(this.behaviorsRegistry.get(t))(e,this.wrapContents(e),n)},detachBehaviors:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getBehaviorOrder().slice().reverse(),i=0;i<r.length;i++){var o=r[i];t.hasOwnProperty(o)&&this.detachBehavior(e,o,n)}},detachBehavior:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.hasOwnProperty(t)&&e[t].destructor(),!n)for(var r in e.behaviors)if(e.behaviors.hasOwnProperty(r)&&this._checkBehaviorDependencies(e,r).length>0)throw new Error('You just removed the "'+t+'" behavior, which "'+r+'" requires.')},_checkBehaviorDependencies:function(e,t){for(var n=this.behaviorsRegistry.get(t),r=[],i=0;i<n.behaviorDependencies.length;i++){var o=n.behaviorDependencies[i];if("^"===o.charAt(0)){var a=o.slice(1);e.parentElement.hasOwnProperty(a)||r.push(o)}else e.hasOwnProperty(o)||r.push(o)}return r},defineCondition:function(e,t){this.conditionsRegistry.add(e,t)},getDefinedConditionNames:function(){return this.conditionsRegistry.getNames()},componentConnected:function(e){var t=new ir.default("scrollmeister:connected",{bubbles:!1,cancelable:!1,detail:e});document.dispatchEvent(t)},componentDisconnected:function(e){var t=new ir.default("scrollmeister:disconnected",{bubbles:!1,cancelable:!1,detail:e});document.dispatchEvent(t)},wrapContents:function(e){if("element-meister"!==e.tagName.toLowerCase())return null;var t=e.querySelector("content-meister");if(t)return t;t=document.createElement("content-meister");for(var n=e.childNodes,r=document.createDocumentFragment();n.length>0;)r.appendChild(n[0]);return t.appendChild(r),e.appendChild(t),t}};rr.default=ur;var lr=br(rr),cr=br(On),fr=br(zn),hr=br(sn),pr=br(Tt),dr=br(Mt),vr=br(ke),yr=br(An),mr=br(Bn);function br(e){return e&&e.__esModule?e:{default:e}}lr.default.registerBehavior(cr.default),lr.default.registerBehavior(fr.default),lr.default.registerBehavior(hr.default),lr.default.registerBehavior(pr.default),lr.default.registerBehavior(dr.default),lr.default.registerBehavior(vr.default),lr.default.registerBehavior(yr.default),lr.default.registerBehavior(mr.default);var gr=Cr(rr),_r=Cr(Re),wr=Cr(Ve),xr=Cr(ft),Tr=Cr($e),Or=Cr(fe),Er=Cr(tt),kr=Cr(ge),Sr=Cr(Ce),Mr=Cr(mt),Pr=Cr(ie),jr=Cr(at),Ar=Cr(J);function Cr(e){return e&&e.__esModule?e:{default:e}}gr.default.registerBehavior(_r.default),gr.default.registerBehavior(wr.default),gr.default.registerBehavior(xr.default),gr.default.registerBehavior(Tr.default),gr.default.registerBehavior(Or.default),gr.default.registerBehavior(Er.default),gr.default.registerBehavior(kr.default),gr.default.registerBehavior(Sr.default),gr.default.registerBehavior(Mr.default),gr.default.registerBehavior(Pr.default),gr.default.registerBehavior(jr.default),gr.default.registerBehavior(Ar.default);!function(e,t){"use strict";var n=e.document,r=e.Object,i=function(e){var t,n,i,o,a=/^[A-Z]+[a-z]/,s=function(e,t){(t=t.toLowerCase())in u||(u[e]=(u[e]||[]).concat(t),u[t]=u[t.toUpperCase()]=e)},u=(r.create||r)(null),l={};for(n in e)for(o in e[n])for(i=e[n][o],u[o]=i,t=0;t<i.length;t++)u[i[t].toLowerCase()]=u[i[t].toUpperCase()]=o;return l.get=function(e){return"string"==typeof e?u[e]||(a.test(e)?[]:""):function(e){var t,n=[];for(t in u)e.test(t)&&n.push(t);return n}(e)},l.set=function(e,t){return a.test(e)?s(e,t):s(t,e),l},l}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof t&&(t={type:t||"auto"});var o,a,s,u,l,c,f,h,p,d="registerElement",v="__"+d+(1e5*e.Math.random()>>0),y="addEventListener",m="attached",b="Callback",g="detached",_="extends",w="attributeChanged"+b,x=m+b,T="connected"+b,O="disconnected"+b,E="created"+b,k=g+b,S="ADDITION",M="REMOVAL",P="DOMAttrModified",j="DOMContentLoaded",A="DOMSubtreeModified",C="<",D="=",L=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,H=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],B=[],N=[],R="",I=n.documentElement,F=B.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},z=r.prototype,W=z.hasOwnProperty,V=z.isPrototypeOf,q=r.defineProperty,U=[],Y=r.getOwnPropertyDescriptor,G=r.getOwnPropertyNames,Q=r.getPrototypeOf,X=r.setPrototypeOf,$=!!r.__proto__,K="__dreCEv1",Z=e.customElements,J=!/^force/.test(t.type)&&!!(Z&&Z.define&&Z.get&&Z.whenDefined),ee=r.create||r,te=e.Map||function(){var e,t=[],n=[];return{get:function(e){return n[F.call(t,e)]},set:function(r,i){(e=F.call(t,r))<0?n[t.push(r)-1]=i:n[e]=i}}},ne=e.Promise||function(e){var t=[],n=!1,r={catch:function(){return r},then:function(e){return t.push(e),n&&setTimeout(i,1),r}};function i(e){for(n=!0;t.length;)t.shift()(e)}return e(i),r},re=!1,ie=ee(null),oe=ee(null),ae=new te,se=function(e){return e.toLowerCase()},ue=r.create||function e(t){return t?(e.prototype=t,new e):this},le=X||($?function(e,t){return e.__proto__=t,e}:G&&Y?function(){function e(e,t){for(var n,r=G(t),i=0,o=r.length;i<o;i++)n=r[i],W.call(e,n)||q(e,n,Y(t,n))}return function(t,n){do{e(t,n)}while((n=Q(n))&&!V.call(n,t));return t}}():function(e,t){for(var n in t)e[n]=t[n];return e}),ce=e.MutationObserver||e.WebKitMutationObserver,fe=(e.HTMLElement||e.Element||e.Node).prototype,he=!V.call(fe,I),pe=he?function(e,t,n){return e[t]=n.value,e}:q,de=he?function(e){return 1===e.nodeType}:function(e){return V.call(fe,e)},ve=he&&[],ye=fe.attachShadow,me=fe.cloneNode,be=fe.dispatchEvent,ge=fe.getAttribute,_e=fe.hasAttribute,we=fe.removeAttribute,xe=fe.setAttribute,Te=n.createElement,Oe=Te,Ee=ce&&{attributes:!0,characterData:!0,attributeOldValue:!0},ke=ce||function(e){Ae=!1,I.removeEventListener(P,ke)},Se=0,Me=d in n&&!/^force-all/.test(t.type),Pe=!0,je=!1,Ae=!0,Ce=!0,De=!0;function Le(){var e=o.splice(0,o.length);for(Se=0;e.length;)e.shift().call(null,e.shift())}function He(e,t){for(var n=0,r=e.length;n<r;n++)Ue(e[n],t)}function Be(e){return function(t){de(t)&&(Ue(t,e),R.length&&He(t.querySelectorAll(R),e))}}function Ne(e){var t=ge.call(e,"is"),n=e.nodeName.toUpperCase(),r=F.call(B,t?D+t.toUpperCase():C+n);return t&&-1<r&&!Re(n,t)?-1:r}function Re(e,t){return-1<R.indexOf(e+'[is="'+t+'"]')}function Ie(e){var t=e.currentTarget,n=e.attrChange,r=e.attrName,i=e.target,o=e[S]||2,a=e[M]||3;!De||i&&i!==t||!t[w]||"style"===r||e.prevValue===e.newValue&&(""!==e.newValue||n!==o&&n!==a)||t[w](r,n===o?null:e.prevValue,n===a?null:e.newValue)}function Fe(e){var t=Be(e);return function(e){o.push(t,e.target),Se&&clearTimeout(Se),Se=setTimeout(Le,1)}}function ze(e){Ce&&(Ce=!1,e.currentTarget.removeEventListener(j,ze)),R.length&&He((e.target||n).querySelectorAll(R),e.detail===g?g:m),he&&function(){for(var e,t=0,n=ve.length;t<n;t++)e=ve[t],I.contains(e)||(n--,ve.splice(t--,1),Ue(e,g))}()}function We(e,t){xe.call(this,e,t),a.call(this,{target:this})}function Ve(e,t){le(e,t),l?l.observe(e,Ee):(Ae&&(e.setAttribute=We,e[v]=u(e),e[y](A,a)),e[y](P,Ie)),e[E]&&De&&(e.created=!0,e[E](),e.created=!1)}function qe(e){throw new Error("A "+e+" type is already registered")}function Ue(e,t){var n,r,i=Ne(e);-1<i&&(f(e,N[i]),i=0,t!==m||e[m]?t!==g||e[g]||(e[m]=!1,e[g]=!0,r="disconnected",i=1):(e[g]=!1,e[m]=!0,r="connected",i=1,he&&F.call(ve,e)<0&&ve.push(e)),i&&(n=e[t+b]||e[r+b])&&n.call(e))}function Ye(){}function Ge(e,t,r){var i=r&&r[_]||"",o=t.prototype,a=ue(o),s=t.observedAttributes||U,u={prototype:a};pe(a,E,{value:function(){if(re)re=!1;else if(!this[K]){this[K]=!0,new t(this),o[E]&&o[E].call(this);var e=ie[ae.get(t)];(!J||e.create.length>1)&&$e(this)}}}),pe(a,w,{value:function(e){-1<F.call(s,e)&&o[w].apply(this,arguments)}}),o[T]&&pe(a,x,{value:o[T]}),o[O]&&pe(a,k,{value:o[O]}),i&&(u[_]=i),e=e.toUpperCase(),ie[e]={constructor:t,create:i?[i,se(e)]:[e]},ae.set(t,e),n[d](e.toLowerCase(),u),Ke(e),oe[e].r()}function Qe(e){var t=ie[e.toUpperCase()];return t&&t.constructor}function Xe(e){return"string"==typeof e?e:e&&e.is||""}function $e(e){for(var t,n=e[w],r=n?e.attributes:U,i=r.length;i--;)t=r[i],n.call(e,t.name||t.nodeName,null,t.value||t.nodeValue)}function Ke(e){return(e=e.toUpperCase())in oe||(oe[e]={},oe[e].p=new ne(function(t){oe[e].r=t})),oe[e].p}function Ze(){Z&&delete e.customElements,q(e,"customElements",{configurable:!0,value:new Ye}),q(e,"CustomElementRegistry",{configurable:!0,value:Ye});for(var t=function(t){var r=e[t];if(r){e[t]=function(e){var t,i;return e||(e=this),e[K]||(re=!0,t=ie[ae.get(e.constructor)],(e=(i=J&&1===t.create.length)?Reflect.construct(r,U,t.constructor):n.createElement.apply(n,t.create))[K]=!0,re=!1,i||$e(e)),e},e[t].prototype=r.prototype;try{r.prototype.constructor=e[t]}catch(n){q(r,K,{value:e[t]})}}},r=i.get(/^HTML[A-Z]*[a-z]/),o=r.length;o--;t(r[o]));n.createElement=function(e,t){var n=Xe(t);return n?Oe.call(this,e,se(n)):Oe.call(this,e)},Me||(je=!0,n[d](""))}if(ce&&((p=n.createElement("div")).innerHTML="<div><div></div></div>",new ce(function(e,t){if(e[0]&&"childList"==e[0].type&&!e[0].removedNodes[0].childNodes.length){var n=(p=Y(fe,"innerHTML"))&&p.set;n&&q(fe,"innerHTML",{set:function(e){for(;this.lastChild;)this.removeChild(this.lastChild);n.call(this,e)}})}t.disconnect(),p=null}).observe(p,{childList:!0,subtree:!0}),p.innerHTML=""),Me||(X||$?(f=function(e,t){V.call(t,e)||Ve(e,t)},h=Ve):h=f=function(e,t){e[v]||(e[v]=r(!0),Ve(e,t))},he?(Ae=!1,function(){var e=Y(fe,y),t=e.value,n=function(e){var t=new CustomEvent(P,{bubbles:!0});t.attrName=e,t.prevValue=ge.call(this,e),t.newValue=null,t[M]=t.attrChange=2,we.call(this,e),be.call(this,t)},r=function(e,t){var n=_e.call(this,e),r=n&&ge.call(this,e),i=new CustomEvent(P,{bubbles:!0});xe.call(this,e,t),i.attrName=e,i.prevValue=n?r:null,i.newValue=t,n?i.MODIFICATION=i.attrChange=1:i[S]=i.attrChange=0,be.call(this,i)},i=function(e){var t,n=e.currentTarget,r=n[v],i=e.propertyName;r.hasOwnProperty(i)&&(r=r[i],(t=new CustomEvent(P,{bubbles:!0})).attrName=r.name,t.prevValue=r.value||null,t.newValue=r.value=n[i]||null,null==t.prevValue?t[S]=t.attrChange=0:t.MODIFICATION=t.attrChange=1,be.call(n,t))};e.value=function(e,o,a){e===P&&this[w]&&this.setAttribute!==r&&(this[v]={className:{name:"class",value:this.className}},this.setAttribute=r,this.removeAttribute=n,t.call(this,"propertychange",i)),t.call(this,e,o,a)},q(fe,y,e)}()):ce||(I[y](P,ke),I.setAttribute(v,1),I.removeAttribute(v),Ae&&(a=function(e){var t,n,r;if(this===e.target){for(r in t=this[v],this[v]=n=u(this),n){if(!(r in t))return s(0,this,r,t[r],n[r],S);if(n[r]!==t[r])return s(1,this,r,t[r],n[r],"MODIFICATION")}for(r in t)if(!(r in n))return s(2,this,r,t[r],n[r],M)}},s=function(e,t,n,r,i,o){var a={attrChange:e,currentTarget:t,attrName:n,prevValue:r,newValue:i};a[o]=e,Ie(a)},u=function(e){for(var t,n,r={},i=e.attributes,o=0,a=i.length;o<a;o++)"setAttribute"!==(n=(t=i[o]).name)&&(r[n]=t.value);return r})),n[d]=function(e,t){if(r=e.toUpperCase(),Pe&&(Pe=!1,ce?(l=function(e,t){function n(e,t){for(var n=0,r=e.length;n<r;t(e[n++]));}return new ce(function(r){for(var i,o,a,s=0,u=r.length;s<u;s++)"childList"===(i=r[s]).type?(n(i.addedNodes,e),n(i.removedNodes,t)):(o=i.target,De&&o[w]&&"style"!==i.attributeName&&(a=ge.call(o,i.attributeName))!==i.oldValue&&o[w](i.attributeName,i.oldValue,a))})}(Be(m),Be(g)),(c=function(e){return l.observe(e,{childList:!0,subtree:!0}),e})(n),ye&&(fe.attachShadow=function(){return c(ye.apply(this,arguments))})):(o=[],n[y]("DOMNodeInserted",Fe(m)),n[y]("DOMNodeRemoved",Fe(g))),n[y](j,ze),n[y]("readystatechange",ze),fe.cloneNode=function(e){var t=me.call(this,!!e),n=Ne(t);return-1<n&&h(t,N[n]),e&&R.length&&function(e){for(var t,n=0,r=e.length;n<r;n++)t=e[n],h(t,N[Ne(t)])}(t.querySelectorAll(R)),t}),je)return je=!1;if(-2<F.call(B,D+r)+F.call(B,C+r)&&qe(e),!L.test(r)||-1<F.call(H,r))throw new Error("The type "+e+" is invalid");var r,i,a=function(){return u?n.createElement(f,r):n.createElement(f)},s=t||z,u=W.call(s,_),f=u?t[_].toUpperCase():r;return u&&-1<F.call(B,C+f)&&qe(f),i=B.push((u?D:C)+r)-1,R=R.concat(R.length?",":"",u?f+'[is="'+e.toLowerCase()+'"]':f),a.prototype=N[i]=W.call(s,"prototype")?s.prototype:ue(fe),R.length&&He(n.querySelectorAll(R),m),a},n.createElement=Oe=function(e,t){var r=Xe(t),i=r?Te.call(n,e,se(r)):Te.call(n,e),o=""+e,a=F.call(B,(r?D:C)+(r||o).toUpperCase()),s=-1<a;return r&&(i.setAttribute("is",r=r.toLowerCase()),s&&(s=Re(o.toUpperCase(),r))),De=!n.createElement.innerHTMLHelper,s&&h(i,N[a]),i}),Ye.prototype={constructor:Ye,define:J?function(e,t,n){if(n)Ge(e,t,n);else{var r=e.toUpperCase();ie[r]={constructor:t,create:[r]},ae.set(t,r),Z.define(e,t)}}:Ge,get:J?function(e){return Z.get(e)||Qe(e)}:Qe,whenDefined:J?function(e){return ne.race([Z.whenDefined(e),Ke(e)])}:Ke},!Z||/^force/.test(t.type))Ze();else if(!t.noBuiltIn)try{!function(t,r,i){if(r[_]="a",(t.prototype=ue(HTMLAnchorElement.prototype)).constructor=t,e.customElements.define(i,t,r),ge.call(n.createElement("a",{is:i}),"is")!==i||J&&ge.call(new t,"is")!==i)throw r}(function e(){return Reflect.construct(HTMLAnchorElement,[],e)},{},"document-register-element-a")}catch(e){Ze()}if(!t.noBuiltIn)try{Te.call(n,"a","a")}catch(e){se=function(e){return{is:e.toLowerCase()}}}}(window);var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});var Lr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Hr=/translate\(([^)]+)\)/g,Br=function(){function e(t,n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.el=t,this.order=n,this._styles={}}return Lr(e,[{key:"setBehaviorStyle",value:function(e,t,n){this._styles.hasOwnProperty(t)||(this._styles[t]={}),this._styles[t][e]=n,this._applyBehaviorStyle(t)}},{key:"resetBehaviorStyle",value:function(e,t){this._styles.hasOwnProperty(t)&&this._styles[t].hasOwnProperty(e)&&(delete this._styles[t][e],this._applyBehaviorStyle(t))}},{key:"resetBehaviorStyles",value:function(e){for(var t in this._styles)this.resetBehaviorStyle(e,t)}},{key:"_applyBehaviorStyle",value:function(e){if("transform"!==e)if("opacity"===e){var t=1;for(var n in this._styles.opacity)this._styles.opacity.hasOwnProperty(n)&&(t*=this._styles.opacity[n]);this.el.style.opacity=t}else{var r=!1;for(var i in this._styles[e])this._styles[e].hasOwnProperty(i)&&(this.el.style[e]=this._styles[e][i],r=!0);r||(this.el.style[e]="")}else{for(var o=[],a=0;a<this.order.length;a++){var s=this.order[a];this._styles.transform.hasOwnProperty(s)&&o.push(this._styles.transform[s])}(o=o.join(" ")).length>0?(this.el.style.transform=this.el.style.WebkitTransform=o.replace(Hr,"translate3d($1, 0)"),this.el.style.msTransform=o):this.el.style.transform=""}}}]),e}();Dr.default=Br;var Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});var Rr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ir=zr(rr),Fr=zr(Dr);function zr(e){return e&&e.__esModule?e:{default:e}}function Wr(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Vr=function(e){function t(e){var n;return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=Wr(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),e=n).init(),Wr(n,e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,HTMLElement),Rr(t,[{key:"init",value:function(){this._behaviorsStyleMerger=new Fr.default(this,Ir.default.getBehaviorOrder())}},{key:"setBehaviorStyle",value:function(e,t,n){this._behaviorsStyleMerger.setBehaviorStyle(e,t,n)}},{key:"resetBehaviorStyle",value:function(e,t){this._behaviorsStyleMerger.resetBehaviorStyle(e,t)}},{key:"resetBehaviorStyles",value:function(e){this._behaviorsStyleMerger.resetBehaviorStyles(e)}}]),t}();Nr.default=Vr;var qr={};Object.defineProperty(qr,"__esModule",{value:!0});var Ur=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Yr=Xr(Xt),Gr=Xr(rr),Qr=Xr(Dr);function Xr(e){return e&&e.__esModule?e:{default:e}}function $r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Kr=[":not(scroll-meister) > element-meister","scroll-meister * element-meister","scroll-meister scroll-meister","element-meister element-meister","element-meister scroll-meister"],Zr=function(e){function t(e){var n;return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),(n=$r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),e=n).init(),$r(n,e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,HTMLElement),Ur(t,[{key:"isConnected",get:function(){return!!document.body&&document.body.contains(this)}}]),Ur(t,[{key:"init",value:function(){this.behaviors={},this._behaviorsStyleMerger=new Qr.default(this,Gr.default.getBehaviorOrder()),this._scheduledBatchUpdate=!1,this._scheduledBehaviors={attach:{},detach:{}}}},{key:"connectedCallback",value:function(){var e=this;this._scheduledBatchUpdate&&!this._batchHandle&&(this._batchHandle=(0,Yr.default)(this._batchUpdateBehaviors.bind(this))),Gr.default.componentConnected(this),(0,Yr.default)(function(){document.querySelector(Kr.join(","))&&e.renderError(new Error("You have nested <scroll-meister> and <element-meister> elements in an unsupported way. <element-meister> elements need to always be direct children of <scroll-meister>."))})}},{key:"disconnectedCallback",value:function(){this.isConnected||(this._scheduledBatchUpdate=!1,Yr.default.cancel(this._batchHandle),delete this._batchHandle,Gr.default.detachBehaviors(this,this.behaviors,!0),Gr.default.componentDisconnected(this))}},{key:"attributeChangedCallback",value:function(e,t,n){null===n?(this._scheduledBehaviors.detach[e]=!0,delete this._scheduledBehaviors.attach[e]):(this._scheduledBehaviors.attach[e]=n,delete this._scheduledBehaviors.detach[e]),this._scheduledBatchUpdate||(this._scheduledBatchUpdate=!0,this.isConnected&&(this._batchHandle=(0,Yr.default)(this._batchUpdateBehaviors.bind(this))))}},{key:"setBehaviorStyle",value:function(e,t,n){this._behaviorsStyleMerger.setBehaviorStyle(e,t,n)}},{key:"resetBehaviorStyle",value:function(e,t){this._behaviorsStyleMerger.resetBehaviorStyle(e,t)}},{key:"resetBehaviorStyles",value:function(e){this._behaviorsStyleMerger.resetBehaviorStyles(e)}},{key:"renderError",value:function(e){}},{key:"_batchUpdateBehaviors",value:function(){this._scheduledBatchUpdate=!1,Gr.default.attachBehaviors(this,this._scheduledBehaviors.attach),this._scheduledBehaviors.attach={},Gr.default.detachBehaviors(this,this._scheduledBehaviors.detach),this._scheduledBehaviors.detach={}}}]),t}();qr.default=Zr;var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});var ei=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ti=ri(rr),ni=ri(qr);function ri(e){return e&&e.__esModule?e:{default:e}}var ii=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,ni.default),ei(t,null,[{key:"observedAttributes",get:function(){for(var e=ti.default.getDefinedBehaviorNames(),t=ti.default.getDefinedConditionNames(),n=e.slice(),r=0;r<e.length;r++)for(var i=e[r],o=0;o<t.length;o++){var a=t[o];n.push(i+"_"+a)}return n}}]),t}();Jr.default=ii;var oi={};Object.defineProperty(oi,"__esModule",{value:!0});var ai=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),si=li(rr),ui=li(qr);function li(e){return e&&e.__esModule?e:{default:e}}var ci=function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,ui.default),ai(t,null,[{key:"observedAttributes",get:function(){for(var e=si.default.getDefinedBehaviorNames(),t=si.default.getDefinedConditionNames(),n=e.slice(),r=0;r<e.length;r++)for(var i=e[r],o=0;o<t.length;o++){var a=t[o];n.push(i+"_"+a)}return n}}]),t}();oi.default=ci;var fi=vi(rr),hi=vi(oi),pi=vi(Jr),di=vi(Nr);function vi(e){return e&&e.__esModule?e:{default:e}}document.addEventListener("DOMContentLoaded",function(){fi.default.behaviorsRegistry.close(),customElements.define("scroll-meister",hi.default),customElements.define("element-meister",pi.default),customElements.define("content-meister",di.default),customElements.define("shadow-meister",function(e){function t(){return function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,HTMLElement),t}())},{once:!0});var yi,mi=(yi=rr)&&yi.__esModule?yi:{default:yi};mi.default.defineCondition("m",function(e){return e.innerWidth>=768},function(e){window.addEventListener("resize",function(){e()},!1),e()}),mi.default.defineCondition("l",function(e){return e.innerWidth>=992}),mi.default.defineCondition("xl",function(e){return e.innerWidth>=1200}),mi.default.defineCondition("s-down",function(e){return e.innerWidth<576}),mi.default.defineCondition("m-down",function(e){return e.innerWidth<768}),mi.default.defineCondition("l-down",function(e){return e.innerWidth<992}),mi.default.defineCondition("xl-down",function(e){return e.innerWidth<1200}),mi.default.defineCondition("portrait",function(e){return e.innerWidth<e.innerHeight}),mi.default.defineCondition("landscape",function(e){return e.innerWidth>=e.innerHeight}),mi.default.defineCondition("webgl",function(){return!0}),mi.default.defineCondition("websockets",function(){return"function"==typeof WebSocket}),mi.default.defineCondition("wat",["xl","portrait"],function(e,t){return e&&t});var bi;!function(e,t){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");t=t||{},r.type="text/css",t.href&&r.setAttribute("data-href",t.href),r.sheet?(r.innerHTML=e,r.sheet.cssText=e):r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t.prepend?n.insertBefore(r,n.childNodes[0]):n.appendChild(r)}("html{overflow-x:hidden;overflow-y:scroll}body{margin:0}scroll-meister{display:block;position:static;width:100%;overflow:hidden}element-meister{display:block;position:fixed;left:0;top:0;opacity:1}content-meister{display:block;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}shadow-meister{position:static !important;display:block;display:contents}\n\n/*# sourceMappingURL=scrollmeister.sass.map */",{});return((bi=rr)&&bi.__esModule?bi:{default:bi}).default});